(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    323132,       8674]
NotebookOptionsPosition[    311138,       8261]
NotebookOutlinePosition[    311496,       8277]
CellTagsIndexPosition[    311453,       8274]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Collaborative Transportation of a Bar by Two Aerial Vehicles with Attitude \
Inner Loop and Experimental Validation\
\>", "Chapter",
 CellChangeTimes->{{3.7133337280710297`*^9, 3.7133337371853333`*^9}}],

Cell[CellGroupData[{

Cell["Notation", "Title",
 CellChangeTimes->{{3.7132780387281313`*^9, 3.713278039914159*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Orthogonal", " ", "Projection", " ", "Operator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OP", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"x", ",", " ", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Skew", " ", "symmetric", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Skew", "[", "\[Omega]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unskew", "[", "x_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Unskew", "[", 
      RowBox[{"Skew", "[", 
       RowBox[{"{", 
        RowBox[{"aa", ",", "bb", ",", "cc"}], "}"}], "]"}], "]"}], "//", 
     "MatrixForm"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{3.712038015027322*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parametrization", " ", "of", " ", "unit", " ", "vector", " ", "with", " ",
     "psi", " ", "and", " ", "theta", " ", "angle"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uv1", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uv1", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"uv3", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e3"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uv3", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Duv1", "[", 
     RowBox[{"\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv1", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       ".", "\[Omega]"}], ")"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "\[Rule]", " ", 
       "\[Theta]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Duv3", "[", 
     RowBox[{"\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv3", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       ".", "\[Omega]"}], ")"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "\[Rule]", " ", 
       "\[Theta]"}], "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{"just", " ", "checking", " ", "orthogonality"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv1", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv1", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv3", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/eaFwSr+wNeOeTM/7ADROvf/HAHRjNNtj4JoF9Wt
vMlA+viz8/wgmu9Q5dTlQFrOacEcEG1jG3ESRCuEMl4B0ZYPH3muANIdx9iD
QPTkvwfzQXTI399FIHrpbYMWEP1Kjm0aiF5++mzoaiA9/+myBBDNYnE4BUQv
uaeWBqK5djruANHbjt09AaK7TpWfBdFnugvOgejfp3z1rwHpMOlMMG0a/NXu
U8Frx1vz++xBtCMfV+vG7teORb2X+kH03qtWC0H01pqqjSC6rPfSdhCddzp2
F4jOWugy6SaQlmP1BNNiwV//WvW8dsxpnsBoDaR3d7/kBdGf03epgGjXtRqa
INqGJccQRBucUf5e1fvaUURvDpjWm+OqdhJIz9SarQ6ipx+bY3UNSC8Lb7AG
0WuunNCMXA5S/0kLTJ/fYQii98hKuoJoAP2O2TA=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Problem Description", "Title",
 CellChangeTimes->{{3.713278103125297*^9, 3.713278107267058*^9}}],

Cell[CellGroupData[{

Cell["State and input", "Chapter",
 CellChangeTimes->{{3.666548864490391*^9, 3.6665488704971523`*^9}, {
  3.713278134774826*^9, 3.713278136413566*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"kinematic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"{", 
      RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{"{", 
      RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", "=", 
     RowBox[{"{", 
      RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zk", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p", ",", "n", ",", "P1", ",", "P2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"dynamic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V1", "=", 
     RowBox[{"{", 
      RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V2", "=", 
     RowBox[{"{", 
      RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zd", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"v", ",", "\[Omega]", ",", "V1", ",", "V2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"zk", ",", "zd"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "input", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{"{", 
      RowBox[{"u1x", ",", "u1y", ",", "u1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{"{", 
      RowBox[{"u2x", ",", "u2y", ",", "u2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"u1", ",", "u2"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
  3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
  3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
  3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
  3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
  3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
  3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
  3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
  3.7117176414614677`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["State set and Tangent set", "Chapter",
 CellChangeTimes->{{3.713278189789266*^9, 3.7132781953309803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZSET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", ".", "n"}], "-", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", ".", "#"}], " ", "-", " ", 
          SuperscriptBox["L1", "2"]}], ")"}], "&"}], ")"}], "[", 
      RowBox[{"P1", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d1", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", ".", "#"}], " ", "-", " ", 
          SuperscriptBox["L2", "2"]}], ")"}], "&"}], ")"}], "[", 
      RowBox[{"P2", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d2", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"n", ".", "\[Omega]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P1", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V1", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P2", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V2", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7116247263438053`*^9, 3.711625080704311*^9}, {
   3.7116327000706253`*^9, 3.711632704034306*^9}, 3.711632961076932*^9, {
   3.711716284722204*^9, 3.711716331960615*^9}, {3.711716510078374*^9, 
   3.711716538794478*^9}, 3.711717833137534*^9, 3.712037969096005*^9, {
   3.7120380976024942`*^9, 3.712038100563798*^9}, {3.712038300858714*^9, 
   3.712038301077929*^9}, {3.7132782015091*^9, 3.713278202796274*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]p", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]px", ",", "\[Delta]py", ",", "\[Delta]pz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]n", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]nx", ",", "\[Delta]ny", ",", "\[Delta]nz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]P1", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]p1x", ",", "\[Delta]p1y", ",", "\[Delta]p1z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]P2", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]p2x", ",", "\[Delta]p2y", ",", "\[Delta]p2z"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]v", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]vx", ",", "\[Delta]vy", ",", "\[Delta]vz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]\[Omega]", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Delta]\[Omega]x", ",", "\[Delta]\[Omega]y", ",", 
       "\[Delta]\[Omega]z"}], "}"}]}], ";", 
    RowBox[{"\[Delta]V1", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]v1x", ",", "\[Delta]v1y", ",", "\[Delta]v1z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]V2", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]v2x", ",", "\[Delta]v2y", ",", "\[Delta]v2z"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TangentZSET", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\[Delta]px_", ",", "\[Delta]py_", ",", "\[Delta]pz_", ",", 
         "\[Delta]nx_", ",", "\[Delta]ny_", ",", "\[Delta]nz_", ",", 
         "\[Delta]p1x_", ",", "\[Delta]p1y_", ",", "\[Delta]p1z_", ",", 
         "\[Delta]p2x_", ",", "\[Delta]p2y_", ",", "\[Delta]p2z_", ",", 
         "\[Delta]vx_", ",", "\[Delta]vy_", ",", "\[Delta]vz_", ",", 
         "\[Delta]\[Omega]x_", ",", "\[Delta]\[Omega]y_", ",", 
         "\[Delta]\[Omega]z_", ",", "\[Delta]v1x_", ",", "\[Delta]v1y_", ",", 
         "\[Delta]v1z_", ",", "\[Delta]v2x_", ",", "\[Delta]v2y_", ",", 
         "\[Delta]v2z_"}], "}"}]}], "\[IndentingNewLine]", "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", ".", "\[Delta]n"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P1", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]P1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", ".", "#2"}], "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P2", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]P2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Delta]n", ".", "\[Omega]"}], "+", 
        RowBox[{"n", ".", "\[Delta]\[Omega]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#3", ".", "#2"}], "+", 
           RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P1", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"V1", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          ",", 
         RowBox[{"\[Delta]P1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]V1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]v", "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], 
            "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
           ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#3", ".", "#2"}], "+", 
           RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P2", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"V2", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          ",", 
         RowBox[{"\[Delta]P2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]V2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]v", "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], 
            "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
           ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.711625093733251*^9, 3.711625459743107*^9}, {
   3.7116255109941187`*^9, 3.711625555179262*^9}, 3.711625588953806*^9, {
   3.711626147955268*^9, 3.711626295203321*^9}, {3.7116263372823677`*^9, 
   3.711626355480554*^9}, 3.711632721094366*^9, {3.7117162848352127`*^9, 
   3.711716332023011*^9}, {3.711716552426841*^9, 3.711716738528173*^9}, 
   3.711716974852784*^9}],

Cell[CellGroupData[{

Cell["\<\
function that generates an arbitrary state in the state space\
\>", "Subchapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.666784754227034*^9, 3.6667847600915203`*^9}, {3.7132781480709343`*^9, 
  3.713278175171763*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zl", "[", "l_", "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"uv1", "[", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "3"}], "]"}], "]"}], "+", 
      RowBox[{"d1", " ", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{"uv3", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"6", ";;", "7"}], "]"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "3"}], "]"}], "]"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{"uv3", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"8", ";;", "9"}], "]"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"10", ";;", "12"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Skew", "[", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"Duv1", "[", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"13", ";;", "14"}], "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"10", ";;", "12"}], "]"}], "]"}], "+", 
      RowBox[{"d1", " ", 
       RowBox[{"Duv1", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"13", ";;", "14"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{"Duv3", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"6", ";;", "7"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"15", ";;", "16"}], "]"}], "]"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"10", ";;", "12"}], "]"}], "]"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"Duv1", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"13", ";;", "14"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{"Duv3", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"8", ";;", "9"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"17", ";;", "18"}], "]"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zlR", "[", "]"}], "=", 
   RowBox[{"zl", "[", 
    RowBox[{"Join", "[", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "18"}], "]"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{"ZSET", "[", 
     RowBox[{"zl", "[", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["y", "#"], "&"}], ",", "18"}], "]"}], "]"}], "]"}], 
    "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"zlR", "[", "]"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.697118200248754*^9, 3.697118239535376*^9}, {
   3.697118360659931*^9, 3.697118470468795*^9}, {3.697118689203661*^9, 
   3.6971187966698236`*^9}, {3.6971188307685328`*^9, 
   3.6971188421873293`*^9}, {3.697118878196802*^9, 3.697118974011015*^9}, {
   3.697119006213297*^9, 3.6971190396741123`*^9}, {3.6971390020228662`*^9, 
   3.697139009318285*^9}, {3.697139373346467*^9, 3.697139374878284*^9}, {
   3.697139414268791*^9, 3.697139469001493*^9}, {3.697141223768364*^9, 
   3.697141227711032*^9}, {3.69731249658494*^9, 3.697312510042843*^9}, {
   3.697400254573415*^9, 3.697400273661202*^9}, {3.697400303986665*^9, 
   3.69740057700772*^9}, {3.697400609630624*^9, 3.697400609841353*^9}, {
   3.698055377956704*^9, 3.698055400306435*^9}, {3.6980554414583282`*^9, 
   3.698055483594681*^9}, {3.7116174218139544`*^9, 3.711617421827387*^9}, 
   3.7116176007977867`*^9, {3.711617938728627*^9, 3.7116180228914537`*^9}, {
   3.711621070398707*^9, 3.711621081343431*^9}, {3.711715923540648*^9, 
   3.711715992726617*^9}, {3.711717833103348*^9, 3.711717833110628*^9}, {
   3.7117370649094048`*^9, 3.7117370657243958`*^9}, {3.712038037186582*^9, 
   3.712038054528998*^9}, {3.713278216614395*^9, 3.713278216818766*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.713278218175419*^9, 3.713279490865651*^9, 
  3.714553395157888*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.711621165123749*^9, 3.711621169743795*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nC1", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   FractionBox[
    RowBox[{"P1", "-", 
     RowBox[{"(", 
      RowBox[{"p", "+", 
       RowBox[{"d1", " ", "n"}]}], ")"}]}], "L1"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nC2", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
    FractionBox[
     RowBox[{"P2", "-", 
      RowBox[{"(", 
       RowBox[{"p", "+", 
        RowBox[{"d2", " ", "n"}]}], ")"}]}], "L2"]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]C1", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Skew", "[", 
     RowBox[{"nC1", "[", "z", "]"}], "]"}], ".", 
    FractionBox[
     RowBox[{"V1", "-", 
      RowBox[{"(", 
       RowBox[{"v", "+", 
        RowBox[{"d1", " ", 
         RowBox[{
          RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}], 
     "L1"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]C2", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{"nC2", "[", "z", "]"}], "]"}], ".", 
     FractionBox[
      RowBox[{"V2", "-", 
       RowBox[{"(", 
        RowBox[{"v", "+", 
         RowBox[{"d2", " ", 
          RowBox[{
           RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}], 
      "L2"]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MT", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["m", "m1"], ",", 
          FractionBox["m", "m2"]}], "}"}], "]"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "\[Gamma]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ",", "1"}], "}"}]}], "}"}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "d1", " ", "d2"}], "J"], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["d1", "d2"], " ", 
             RowBox[{"\[Delta]1", ".", "\[Delta]1"}]}], ",", 
            RowBox[{"\[Delta]1", ".", "\[Delta]2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]1", ".", "\[Delta]2"}], ",", 
            RowBox[{
             FractionBox["d2", "d1"], 
             RowBox[{"\[Delta]2", ".", "\[Delta]2"}]}]}], "}"}]}], "}"}]}]}], 
      ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Gamma]", "\[Rule]", " ", 
        RowBox[{
         RowBox[{"nC1", "[", "z", "]"}], ".", 
         RowBox[{"nC2", "[", "z", "]"}]}]}], ",", 
       RowBox[{"\[Delta]1", "\[Rule]", " ", 
        RowBox[{
         RowBox[{"Skew", "[", "n", "]"}], ".", 
         RowBox[{"nC1", "[", "z", "]"}]}]}], ",", 
       RowBox[{"\[Delta]2", "\[Rule]", " ", 
        RowBox[{
         RowBox[{"Skew", "[", "n", "]"}], ".", 
         RowBox[{"nC2", "[", "z", "]"}]}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"nC1", "[", "z", "]"}], ".", "u1"}], 
        FractionBox["m", "m1"]}], "+", 
       RowBox[{
        FractionBox["m", "L1"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
         RowBox[{"V1", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          "]"}]}], "+", " ", 
       RowBox[{"m", " ", "d1", " ", 
        RowBox[{
         RowBox[{"nC1", "[", "z", "]"}], ".", "n"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", "]"}]}]}], 
      ")"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"nC2", "[", "z", "]"}], ".", "u2"}], 
        FractionBox["m", "m2"]}], "+", 
       RowBox[{
        FractionBox["m", "L2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
         RowBox[{"V2", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          "]"}]}], "+", " ", 
       RowBox[{"m", " ", "d2", " ", 
        RowBox[{
         RowBox[{"nC2", "[", "z", "]"}], ".", "n"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", "]"}]}]}], 
      ")"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Te", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
        "u2z_"}], "}"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"MT", "[", "zk", "]"}], "]"}], ".", 
     RowBox[{"BB", "[", 
      RowBox[{"z", ",", "u"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "m"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"T1", " ", 
        RowBox[{"nC1", "[", "z", "]"}]}], "+", 
       RowBox[{"T2", " ", 
        RowBox[{"nC2", "[", "z", "]"}]}], "-", " ", 
       RowBox[{"m", " ", "gravity", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
      RowBox[{"Te", "[", 
       RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]B", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "J"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Skew", "[", 
          RowBox[{"d1", " ", "n"}], "]"}], ".", 
         RowBox[{"nC1", "[", "z", "]"}]}], " ", "T1"}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Skew", "[", 
          RowBox[{"d2", " ", "n"}], "]"}], ".", 
         RowBox[{"nC2", "[", "z", "]"}]}], "T2"}]}], ")"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
      RowBox[{"Te", "[", 
       RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A1", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "m1"], 
     RowBox[{"(", 
      RowBox[{"u1", "-", 
       RowBox[{"T1", " ", 
        RowBox[{"nC1", "[", "z", "]"}]}], "-", " ", 
       RowBox[{"m1", " ", "gravity", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
      RowBox[{"Te", "[", 
       RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
        "u2z_"}], "}"}]}], "]"}], "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", "m2"], 
      RowBox[{"(", 
       RowBox[{"u2", "-", 
        RowBox[{"T2", " ", 
         RowBox[{"nC2", "[", "z", "]"}]}], "-", " ", 
        RowBox[{"m2", " ", "gravity", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
       RowBox[{"Te", "[", 
        RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Zk", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{"v", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}], ",", 
      "\[IndentingNewLine]", "V1", ",", "\[IndentingNewLine]", "V2"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Zd", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
        "u2z_"}], "}"}]}], "]"}], "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]B", "[", 
       RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"A1", "[", 
       RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"A2", "[", 
       RowBox[{"z", ",", "u"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", " ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Zk", "[", "z", "]"}], ",", 
     RowBox[{"Zd", "[", 
      RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.697400682497552*^9, 3.697400683235924*^9}, 
   3.697400813783896*^9, {3.697400858437114*^9, 3.697400871115472*^9}, {
   3.697400908311493*^9, 3.697401159068199*^9}, {3.698055586122117*^9, 
   3.698055588296116*^9}, {3.698056542684677*^9, 3.698056552466524*^9}, {
   3.698235111344733*^9, 3.69823512671377*^9}, {3.6982366567826138`*^9, 
   3.6982366803944607`*^9}, {3.698237041849807*^9, 3.698237062183079*^9}, {
   3.698296328890626*^9, 3.698296382642074*^9}, {3.698296426982251*^9, 
   3.698296484584517*^9}, {3.698296525845749*^9, 3.698296558333123*^9}, {
   3.698296594014716*^9, 3.698296639109754*^9}, {3.698296715695365*^9, 
   3.698296766142324*^9}, {3.698296829912444*^9, 3.6982968462241087`*^9}, {
   3.698296919475834*^9, 3.6982969512167892`*^9}, {3.6982970081121407`*^9, 
   3.6982971601189327`*^9}, {3.7116172924516172`*^9, 
   3.7116173135692368`*^9}, {3.711617600829135*^9, 3.711617600834444*^9}, {
   3.7116211814820538`*^9, 3.7116211903545094`*^9}, {3.711621674121518*^9, 
   3.711621684289032*^9}, {3.7116226266695623`*^9, 3.711622657368965*^9}, {
   3.7116227064891872`*^9, 3.711622875093487*^9}, {3.711623073320809*^9, 
   3.7116230935901937`*^9}, {3.711623124016121*^9, 3.711623136621789*^9}, {
   3.711623194100933*^9, 3.7116232225230007`*^9}, {3.711623291248263*^9, 
   3.7116233162765017`*^9}, {3.711626131209844*^9, 3.711626132107855*^9}, {
   3.711626373708078*^9, 3.7116263753900623`*^9}, {3.7116264742237577`*^9, 
   3.711626679957713*^9}, {3.711626725144823*^9, 3.711626778033641*^9}, {
   3.71162689733743*^9, 3.7116269922027283`*^9}, {3.711627036057825*^9, 
   3.711627037440173*^9}, {3.7116279668739223`*^9, 3.711627995359263*^9}, {
   3.7116280287955837`*^9, 3.711628078391036*^9}, {3.711628446905264*^9, 
   3.711628816619896*^9}, {3.711628849708926*^9, 3.711628851675909*^9}, {
   3.711628903811613*^9, 3.711629021299794*^9}, {3.711629084199346*^9, 
   3.7116292645521173`*^9}, {3.711629298749126*^9, 3.711629334010613*^9}, {
   3.711630407964484*^9, 3.711630461296159*^9}, {3.7116327828384447`*^9, 
   3.7116328480417957`*^9}, {3.711632986156638*^9, 3.71163302875439*^9}, {
   3.71163307677535*^9, 3.711633080282186*^9}, 3.7116331265298433`*^9, {
   3.711689294866427*^9, 3.711689298484226*^9}, {3.711716284965667*^9, 
   3.7117163320871058`*^9}, {3.711716755984516*^9, 3.7117168689313707`*^9}, {
   3.711716914097118*^9, 3.711716926278614*^9}, {3.711716978791876*^9, 
   3.711717134159712*^9}, 3.7117173042513313`*^9, {3.711723906207171*^9, 
   3.7117239189962263`*^9}, 3.712038129588223*^9, {3.712039142693501*^9, 
   3.712039273186387*^9}, {3.712043072787568*^9, 3.712043075086792*^9}, {
   3.7132782381499043`*^9, 3.713278238449499*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["checking that vector field is within tangent set", "Chapter",
 CellChangeTimes->{{3.712038811277717*^9, 3.712038834014045*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Z", "[", 
     RowBox[{
      RowBox[{"zlR", "[", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
       "}"}]}], "]"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Chop", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TangentZSET", "[", 
       RowBox[{"z", ",", 
        RowBox[{"Z", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z", "\[Rule]", " ", 
        RowBox[{"zl", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "18"}], "]"}], 
         "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
         "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.",
     "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{"u", "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.711633142776978*^9, 3.711633142957838*^9}, {
   3.711633207554667*^9, 3.711633208645482*^9}, 3.711633238773624*^9, {
   3.71163407516049*^9, 3.711634139805245*^9}, {3.711717396201397*^9, 
   3.711717418048194*^9}, 3.711717480473504*^9, {3.711717833150804*^9, 
   3.711717833157578*^9}, {3.7120381316591873`*^9, 3.712038187889556*^9}, {
   3.712038320716567*^9, 3.712038339377733*^9}, {3.712038369407885*^9, 
   3.712038371599181*^9}, {3.712038633411572*^9, 3.712038651549141*^9}, {
   3.712038783309617*^9, 3.7120388016940727`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7120381152681627`*^9, 3.712038195254126*^9}, 
   3.7120382373104057`*^9, 3.7120383560503407`*^9, 3.712038462602194*^9, 
   3.712038802489809*^9, 3.7120392870802507`*^9, 3.7120400533716917`*^9, 
   3.7120490080286407`*^9, 3.712058597787944*^9, 3.712987500097949*^9, 
   3.71327829244942*^9, 3.713279491321258*^9, 3.714553395623385*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equilibrium state and input (vector field must vanish)", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
  3.713278266852682*^9, 3.713278272707423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zeq", "=", 
  RowBox[{"zl", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.712038990164638*^9, 3.712038992606546*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "d1", ",", "0", 
   ",", "L1", ",", "d2", ",", "0", ",", "L2", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7120389938649797`*^9, 3.71204005300133*^9, 3.7120490073703136`*^9, 
   3.7120585974579887`*^9, 3.712987499183563*^9, {3.713278276664546*^9, 
   3.713278295311286*^9}, 3.713279491391636*^9, 3.7145533956837673`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ueq", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"m1", " ", "gravity"}], " ", "+", 
      FractionBox[
       RowBox[{"d2", " ", "gravity", " ", "m"}], 
       RowBox[{"d2", "-", "d1"}]]}], ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"m2", " ", "gravity"}], " ", "+", 
      FractionBox[
       RowBox[{"d1", " ", "gravity", " ", "m"}], 
       RowBox[{"d1", "-", "d2"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"zeq", ",", "ueq"}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.712039055245289*^9, 3.712039075825623*^9}, {
  3.712039346484489*^9, 3.7120393530212927`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7120390778142*^9, 3.712039291443241*^9, 3.712039350241049*^9, 
   3.712040055316514*^9, 3.7120490081384573`*^9, 3.712058597871005*^9, 
   3.712987500577548*^9, {3.713278278319495*^9, 3.713278296302514*^9}, 
   3.7132794914656963`*^9, 3.714553395799411*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["PD Control Law", "Title",
 CellChangeTimes->{{3.7120393698603773`*^9, 3.7120393804879923`*^9}, {
  3.713278317965885*^9, 3.713278325301228*^9}}],

Cell[CellGroupData[{

Cell["pd controllers with saturations", "Chapter",
 CellChangeTimes->{{3.713278366129385*^9, 3.713278372015209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ux", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpx"}], " ", "p"}], " ", "-", " ", 
     RowBox[{"kvx", " ", "v"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uy", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpy"}], " ", "p"}], " ", "-", " ", 
     RowBox[{"kvy", " ", "v"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uz", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpz"}], " ", "p"}], " ", "-", " ", 
     RowBox[{"kvz", " ", "v"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ux", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpx"}], " ", 
      FractionBox[
       RowBox[{"\[Sigma]px", " ", "p"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]px", "2"], "+", 
         SuperscriptBox["p", "2"]}]]]}], " ", "-", " ", 
     RowBox[{"kvx", " ", 
      FractionBox[
       RowBox[{"\[Sigma]vx", " ", "v"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]vx", "2"], "+", 
         SuperscriptBox["v", "2"]}]]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uy", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpy"}], " ", 
      FractionBox[
       RowBox[{"\[Sigma]py", " ", "p"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]py", "2"], "+", 
         SuperscriptBox["p", "2"]}]]]}], " ", "-", 
     RowBox[{"kvy", " ", 
      FractionBox[
       RowBox[{"\[Sigma]vy", " ", "v"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]vy", "2"], "+", 
         SuperscriptBox["v", "2"]}]]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uz", "[", 
     RowBox[{"p_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kpz"}], " ", 
      FractionBox[
       RowBox[{"\[Sigma]pz", " ", "p"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]pz", "2"], "+", 
         SuperscriptBox["p", "2"]}]]]}], " ", "-", " ", 
     RowBox[{"kvz", " ", 
      FractionBox[
       RowBox[{"\[Sigma]vz", " ", "v"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Sigma]vz", "2"], "+", 
         SuperscriptBox["v", "2"]}]]]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7120584505551777`*^9, 3.712058476755711*^9}, {
   3.712058541732068*^9, 3.712058565179367*^9}, {3.712058671317902*^9, 
   3.712058721481213*^9}, {3.712058887269067*^9, 3.71205888759383*^9}, {
   3.7120590055443497`*^9, 3.712059009310205*^9}, 3.7120591390329027`*^9, 
   3.713278352256366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Control law for each uav", "Chapter",
 CellChangeTimes->{{3.712040075566353*^9, 3.712040080540077*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "pd", " ", "control", " ", "law", " ", "for", " ", "for", " ", "each", " ",
     "direction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u1cl", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", " ", 
        RowBox[{"ux", "[", 
         RowBox[{
          RowBox[{"p1x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "7", "]"}], "]"}]}], ",", 
          RowBox[{"v1x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "16", "]"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"m1", " ", 
        RowBox[{"uy", "[", 
         RowBox[{
          RowBox[{"p1y", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "8", "]"}], "]"}]}], ",", 
          RowBox[{"v1y", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "17", "]"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m1", " ", "+", " ", 
          FractionBox["m", "2"]}], ")"}], " ", 
        RowBox[{"uz", "[", 
         RowBox[{
          RowBox[{"p1z", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "9", "]"}], "]"}]}], ",", 
          RowBox[{"v1z", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "18", "]"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u2cl", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m2", " ", 
        RowBox[{"ux", "[", 
         RowBox[{
          RowBox[{"p2x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "10", "]"}], "]"}]}], ",", 
          RowBox[{"v2x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "22", "]"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"m2", " ", 
        RowBox[{"uy", "[", 
         RowBox[{
          RowBox[{"p2y", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "11", "]"}], "]"}]}], ",", 
          RowBox[{"v2y", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "23", "]"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m2", " ", "+", " ", 
          FractionBox["m", "2"]}], ")"}], 
        RowBox[{"uz", "[", 
         RowBox[{
          RowBox[{"p2z", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "12", "]"}], "]"}]}], ",", 
          RowBox[{"v2z", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "24", "]"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complete", " ", "control", " ", "law"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ucl", "[", "z_", "]"}], ":=", 
    RowBox[{"ueq", "+", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"u1cl", "[", "z", "]"}], ",", 
       RowBox[{"u2cl", "[", "z", "]"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.678453870578924*^9, 3.6784538851660337`*^9}, {
   3.6784539201437883`*^9, 3.67845426729596*^9}, {3.6784542976203947`*^9, 
   3.678454338207302*^9}, {3.678454368219833*^9, 3.67845442420653*^9}, {
   3.678455564719254*^9, 3.6784555755938787`*^9}, {3.678455667955229*^9, 
   3.67845567412951*^9}, {3.6784557240285482`*^9, 3.67845580636443*^9}, {
   3.67845594497412*^9, 3.6784560056472273`*^9}, {3.678456040740004*^9, 
   3.678456113360455*^9}, {3.6784565804483*^9, 3.6784566989706917`*^9}, {
   3.67845699495473*^9, 3.6784570051161823`*^9}, {3.678457074189624*^9, 
   3.678457074400229*^9}, {3.678457120811713*^9, 3.678457132773929*^9}, {
   3.6784573833439817`*^9, 3.678457399044024*^9}, {3.678457566717965*^9, 
   3.678457575258934*^9}, {3.6784576138433027`*^9, 3.67845764511302*^9}, {
   3.678457681670499*^9, 3.6784576869371843`*^9}, {3.6785030133194637`*^9, 
   3.678503018851026*^9}, {3.678503053700424*^9, 3.678503061887308*^9}, {
   3.6785031141864853`*^9, 3.678503151671834*^9}, {3.6785035454280252`*^9, 
   3.678503565801978*^9}, {3.692605692777117*^9, 3.692605787151251*^9}, {
   3.692605871228614*^9, 3.692605875567656*^9}, {3.697783560030775*^9, 
   3.697783584633834*^9}, {3.697864144145309*^9, 3.6978642846827497`*^9}, {
   3.6978644724858093`*^9, 3.697864474524767*^9}, {3.6978645253057003`*^9, 
   3.697864529099121*^9}, {3.6978648087283993`*^9, 3.697864819666897*^9}, {
   3.697864857946622*^9, 3.697864871615958*^9}, {3.697865030310058*^9, 
   3.697865054256448*^9}, {3.6978653837364273`*^9, 3.697865403161058*^9}, {
   3.697865434075416*^9, 3.697865435874483*^9}, {3.6978655603144903`*^9, 
   3.6978655605135307`*^9}, {3.697878887139681*^9, 3.6978789273146276`*^9}, {
   3.712038875130848*^9, 3.712038878681403*^9}, 3.7120393854066896`*^9, {
   3.712040082366139*^9, 3.712040082678351*^9}, {3.7120401609284153`*^9, 
   3.712040170183938*^9}, {3.712040226413877*^9, 3.712040307061963*^9}, {
   3.7120403525685987`*^9, 3.7120404400933*^9}, {3.7120474726221743`*^9, 
   3.7120474757472897`*^9}, {3.713278396558968*^9, 3.713278399018046*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ucl", "[", "zeq", "]"}], "//", "FullSimplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Zcl", "[", "z_", "]"}], ":=", 
    RowBox[{"Z", "[", 
     RowBox[{"z", ",", 
      RowBox[{"ucl", "[", "z", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zcl", "[", "zeq", "]"}], "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{3.712040480531617*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.71204047834184*^9, 3.7120490084297743`*^9, 3.712058597966004*^9, {
   3.712058705161812*^9, 3.712058730176457*^9}, 3.712058899422492*^9, 
   3.712059023626665*^9, 3.7120591479361553`*^9, 3.712987501128825*^9, 
   3.71327949161626*^9, 3.714553401219016*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh\[CloseCurlyQuote]s Criterion", "Title",
 CellChangeTimes->{{3.7132785071952953`*^9, 3.713278511342277*^9}}],

Cell["Check notebook \[OpenCurlyDoubleQuote]rouths criterion for special \
cases\[CloseCurlyDoubleQuote].nb", "Chapter",
 CellChangeTimes->{{3.713278513305223*^9, 3.713278549191478*^9}}],

Cell["\<\
check that equilibrium properly now (now that closed can be defined) \
\>", "Chapter",
 CellChangeTimes->{{3.7120404506307907`*^9, 3.7120404753435917`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability Analysis of Unit Vector Dynamics", "Title",
 CellChangeTimes->{{3.713278710781695*^9, 3.713278730583387*^9}}],

Cell["\<\
Check notebook \[OpenCurlyDoubleQuote]terms to add negative eigenvalues on \
unit vector dynamics\[CloseCurlyDoubleQuote].nb\
\>", "Chapter",
 CellChangeTimes->{{3.713278750687134*^9, 3.713278765932664*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transformation to unit vectors and Linearization", "Title",
 CellChangeTimes->{{3.713279430695743*^9, 3.713279433744278*^9}}],

Cell[CellGroupData[{

Cell["how we decompose an element from X", "Chapter",
 CellChangeTimes->{{3.712042368804603*^9, 3.712042376232953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"p", ",", "v", ",", "n", ",", "\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1x", ",", "\[Omega]1y", ",", "\[Omega]1z"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.7120423873054333`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["how to generate an arbitrary element in X", "Chapter",
 CellChangeTimes->{{3.712042391342523*^9, 3.712042400667399*^9}, {
  3.713279473887886*^9, 3.7132794766957607`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xl", "[", "l_", "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
    RowBox[{"(*", "p", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"l", "[", 
     RowBox[{"[", 
      RowBox[{"4", ";;", "6"}], "]"}], "]"}], ",", 
    RowBox[{"(*", "v", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"uv1", "[", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"7", ";;", "8"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"(*", "n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{"uv1", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "8"}], "]"}], "]"}], "]"}], "]"}], ".", 
     RowBox[{"Duv1", "[", 
      RowBox[{
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "8"}], "]"}], "]"}], ",", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"9", ";;", "10"}], "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"(*", "\[Omega]", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"uv3", "[", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"11", ";;", "12"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"(*", "n1", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"11", ";;", "12"}], "]"}], "]"}], "]"}], "]"}], ".", 
     RowBox[{"Duv3", "[", 
      RowBox[{
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"11", ";;", "12"}], "]"}], "]"}], ",", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"13", ";;", "14"}], "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"(*", "\[Omega]1", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"uv3", "[", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"15", ";;", "16"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"(*", "n2", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"15", ";;", "16"}], "]"}], "]"}], "]"}], "]"}], ".", 
     RowBox[{"Duv3", "[", 
      RowBox[{
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"15", ";;", "16"}], "]"}], "]"}], ",", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "18"}], "]"}], "]"}]}], "]"}]}]}], 
   RowBox[{"(*", "\[Omega]2", "*)"}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xlR", "[", "]"}], "=", 
   RowBox[{"xl", "[", 
    RowBox[{"Join", "[", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "18"}], "]"}], "]"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712042416380745*^9, 3.7120425870103197`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["maps from Z to X, and from X to Z", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}}],

Cell[CellGroupData[{

Cell["map from Z to X", "Subchapter",
 CellChangeTimes->{{3.712042356743144*^9, 3.712042361817271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gz2x", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
    "p", ",", "v", ",", "n", ",", "\[Omega]", ",", "\[IndentingNewLine]", 
     RowBox[{"nC1", "[", "z", "]"}], ",", 
     RowBox[{"\[Omega]C1", "[", "z", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"nC2", "[", "z", "]"}], ",", 
     RowBox[{"\[Omega]C2", "[", "z", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.712042597308707*^9, {3.712042988735424*^9, 3.712042990098134*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["map from X to Z", "Subchapter",
 CellChangeTimes->{{3.712042608970937*^9, 3.712042622968911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gx2z", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
      "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
      ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
      "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", ",",
       "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
      "\[Omega]2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ",", 
     RowBox[{"(*", "p", "*)"}], "\[IndentingNewLine]", "n", ",", 
     RowBox[{"(*", "n", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p", "+", " ", 
      RowBox[{"d1", " ", "n"}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{"{", 
        RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}], ",", 
     RowBox[{"(*", "P1", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p", "+", " ", 
      RowBox[{"d2", " ", "n"}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{"{", 
        RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}], ",", 
     RowBox[{"(*", "P2", "*)"}], "\[IndentingNewLine]", "v", ",", 
     RowBox[{"(*", "v", "*)"}], "\[IndentingNewLine]", "\[Omega]", ",", 
     RowBox[{"(*", "\[Omega]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"v", "+", " ", 
      RowBox[{"d1", " ", 
       RowBox[{
        RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{
        RowBox[{"Skew", "[", 
         RowBox[{"{", 
          RowBox[{"\[Omega]1x", ",", "\[Omega]1y", ",", "\[Omega]1z"}], "}"}],
          "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}]}], ",", 
     RowBox[{"(*", "V1", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"v", "+", " ", 
      RowBox[{"d2", " ", 
       RowBox[{
        RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{
        RowBox[{"Skew", "[", 
         RowBox[{"{", 
          RowBox[{"\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z"}], "}"}],
          "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}]}]}], 
    RowBox[{"(*", "V2", "*)"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.712042662396578*^9, 3.712042876023643*^9}, {
  3.712042993187603*^9, 3.712042994423571*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check that functions are inverses of each other", "Subchapter",
 CellChangeTimes->{{3.712042882883869*^9, 3.712042891260345*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "functions", " ", "are", " ", "inverse", " ", 
    "of", " ", "each", " ", "other"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{"gz2x", "[", 
         RowBox[{"gx2z", "[", "#", "]"}], "]"}]}], "&"}], "[", 
      RowBox[{"xlR", "[", "]"}], "]"}], "/.", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
         "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{"gx2z", "[", 
         RowBox[{"gz2x", "[", "#", "]"}], "]"}]}], "&"}], "[", 
      RowBox[{"zlR", "[", "]"}], "]"}], "/.", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
         "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.67845584785178*^9, 3.678455854712219*^9}, 
   3.678456012920905*^9, {3.697864291507987*^9, 3.697864294833221*^9}, {
   3.697865567014106*^9, 3.6978656964780617`*^9}, {3.6978657494415607`*^9, 
   3.697866064195986*^9}, {3.697866321562456*^9, 3.697866337475458*^9}, {
   3.697866662260963*^9, 3.697866662410445*^9}, {3.6978668898243513`*^9, 
   3.697866895166657*^9}, {3.6978669622262917`*^9, 3.697866962620947*^9}, {
   3.697868247155408*^9, 3.6978682475039577`*^9}, 3.697869119995756*^9, {
   3.697869168585788*^9, 3.6978691709338083`*^9}, {3.7120422034318123`*^9, 
   3.712042411647298*^9}, {3.712042603569508*^9, 3.7120426471850233`*^9}, {
   3.712042893760047*^9, 3.712042926535187*^9}, 3.712042969549364*^9, {
   3.712043041224017*^9, 3.7120430497859697`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6978658593054247`*^9, 3.697865876709532*^9}, {
   3.697866042732298*^9, 3.697866064524922*^9}, 3.697866377074353*^9, {
   3.697866530791342*^9, 3.697866533702962*^9}, 3.697866599728147*^9, 
   3.697866662943219*^9, {3.697866883120059*^9, 3.697866895548126*^9}, {
   3.6978682403059263`*^9, 3.697868248118331*^9}, {3.697869115510458*^9, 
   3.697869171441428*^9}, 3.6978701058993998`*^9, 3.697871070936721*^9, 
   3.697871406038706*^9, 3.697871995748866*^9, 3.697872145801592*^9, 
   3.697879182250037*^9, 3.697880816726387*^9, 3.6978903805262136`*^9, 
   3.697921718140236*^9, 3.6979574736566477`*^9, 3.69795970756815*^9, {
   3.712042916871994*^9, 3.712042926887772*^9}, 3.7120429715103703`*^9, 
   3.712043002715365*^9, 3.712043050343869*^9, 3.712043096186388*^9, 
   3.7120490088343697`*^9, 3.7120585980414257`*^9, {3.712058705269166*^9, 
   3.712058730239931*^9}, 3.712058899544911*^9, 3.7120590237544537`*^9, 
   3.712059148073797*^9, 3.712987501413439*^9, 3.713279523879575*^9, 
   3.71455343201068*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6978658593054247`*^9, 3.697865876709532*^9}, {
   3.697866042732298*^9, 3.697866064524922*^9}, 3.697866377074353*^9, {
   3.697866530791342*^9, 3.697866533702962*^9}, 3.697866599728147*^9, 
   3.697866662943219*^9, {3.697866883120059*^9, 3.697866895548126*^9}, {
   3.6978682403059263`*^9, 3.697868248118331*^9}, {3.697869115510458*^9, 
   3.697869171441428*^9}, 3.6978701058993998`*^9, 3.697871070936721*^9, 
   3.697871406038706*^9, 3.697871995748866*^9, 3.697872145801592*^9, 
   3.697879182250037*^9, 3.697880816726387*^9, 3.6978903805262136`*^9, 
   3.697921718140236*^9, 3.6979574736566477`*^9, 3.69795970756815*^9, {
   3.712042916871994*^9, 3.712042926887772*^9}, 3.7120429715103703`*^9, 
   3.712043002715365*^9, 3.712043050343869*^9, 3.712043096186388*^9, 
   3.7120490088343697`*^9, 3.7120585980414257`*^9, {3.712058705269166*^9, 
   3.712058730239931*^9}, 3.712058899544911*^9, 3.7120590237544537`*^9, 
   3.712059148073797*^9, 3.712987501413439*^9, 3.713279523879575*^9, 
   3.714553432027999*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equilibrium in X domain", "Chapter",
 CellChangeTimes->{{3.712043129011437*^9, 3.712043133974308*^9}, {
  3.712043170586969*^9, 3.712043171162079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xeq", " ", "=", 
   RowBox[{"gz2x", "[", "zeq", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7120431420117064`*^9, 3.712043155324519*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["vector field in X domain", "Chapter",
 CellChangeTimes->{{3.712043158674334*^9, 3.7120431651368628`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Xcl", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"gz2x", "[", "z", "]"}], ",", 
         RowBox[{"{", "z", "}"}]}], "]"}], "]"}], ".", 
      RowBox[{"Zcl", "[", 
       RowBox[{"gx2z", "[", "x", "]"}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z", "\[Rule]", " ", 
       RowBox[{"gx2z", "[", "x", "]"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xcl", "[", "xeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712043176742127*^9, 3.712043281808378*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7120432784438953`*^9, 3.7120432822128477`*^9}, 
   3.7120490091343107`*^9, 3.712058598271687*^9, {3.712058705472497*^9, 
   3.712058730440316*^9}, 3.712058899737771*^9, 3.712059023956584*^9, 
   3.712059148260346*^9, 3.712987501875455*^9, 3.713279540672968*^9, 
   3.714553432417451*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stability vector fields (see previous section)", "Chapter",
 CellChangeTimes->{{3.71204330563844*^9, 3.7120433098891068`*^9}, {
  3.713279548702609*^9, 3.713279552431737*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalTheta]n", "[", "n_", "]"}], ":=", 
  RowBox[{"\[Lambda]", 
   FractionBox["1", "2"], "n", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"n", ".", "n"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
   RowBox[{"n_", ",", "\[Omega]_"}], "]"}], ":=", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], "n", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"n", ".", "n"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "n"}], " ", 
      RowBox[{"\[Omega]", ".", "n"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xcl3", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Xcl", "[", "x", "]"}], "+", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"13", ";;", "15"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "21"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"22", ";;", "24"}], "]"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xcl3", "[", "xeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697868840056715*^9, 3.6978688523192167`*^9}, {
   3.6978706140388403`*^9, 3.697870623436116*^9}, {3.697872379380107*^9, 
   3.697872379767572*^9}, 3.712040307080044*^9, {3.7120433389391623`*^9, 
   3.7120434575913973`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.697868849553028*^9, 3.6978692021033983`*^9, 3.6978701064513807`*^9, 
   3.697870626278841*^9, 3.6978710716440163`*^9, 3.697871406868058*^9, 
   3.6978719964086113`*^9, 3.697872146607575*^9, 3.697879188689644*^9, 
   3.6978808172836847`*^9, 3.697890381086574*^9, 3.697921718771315*^9, 
   3.69795747448033*^9, 3.697959708131089*^9, {3.7120434527917852`*^9, 
   3.712043458228406*^9}, 3.7120490092331257`*^9, 3.712058598351849*^9, {
   3.712058705536056*^9, 3.7120587304984713`*^9}, 3.712058899797291*^9, 
   3.712059024006012*^9, 3.712059148310895*^9, 3.7129875019902143`*^9, 
   3.713279555425377*^9, 3.714553432482912*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters simplification", "Chapter",
 CellChangeTimes->{{3.712043494752738*^9, 3.712043499090579*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametersSimplification", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", 
      RowBox[{"-", "d"}]}], " ", ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", " ", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], " ", ",", " ", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", " ", 
     RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Xcl3", "[", "x", "]"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"x", "\[Rule]", " ", "xeq"}], "]"}]}], "/.", 
      "ParametersSimplification"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]px", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vx", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]py", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vy", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]pz", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vz", ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.697868867188023*^9, 3.6978689376077003`*^9}, {
   3.697869060394891*^9, 3.69786908876962*^9}, {3.697869212884316*^9, 
   3.697869213358185*^9}, 3.6978696398213882`*^9, {3.7120435302538643`*^9, 
   3.712043574075939*^9}, {3.7120586109226303`*^9, 3.712058665942432*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "kpz"}], "0", "0", 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", "kpz", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "-", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["kpy", "L"], "0", "0", 
      FractionBox["kvy", "L"], "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "kpy"}], "L"], "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "kvy"}], "L"], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", 
      RowBox[{"-", "kvy"}], "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["kpx", "L"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["kvx", "L"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kpx"}], "L"]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M"}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", 
      RowBox[{"-", "kvx"}], "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", 
      FractionBox["kpy", "L"], "0", "0", 
      FractionBox["kvy", "L"], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kpy"}], "L"]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kvy"}], "L"]}], "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", 
      RowBox[{"-", "kvy"}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["kpx", "L"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["kvx", "L"]}], "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "kpx"}], "L"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M"}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", 
      RowBox[{"-", "kvx"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.712043566776472*^9, 3.71204357789284*^9}, 
   3.712049012773232*^9, 3.7120586071895647`*^9, {3.712058710259096*^9, 
   3.712058735151926*^9}, 3.7120589047000732`*^9, 3.712059028459034*^9, 
   3.712059152744329*^9, 3.7129875104659843`*^9, 3.713279587064036*^9, 
   3.714553440193171*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.697869231045278*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"24", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PP", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ".", "A"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "9", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "9", "]"}], ".", "A"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", "13", "]"}], "-", 
       RowBox[{"e", "[", "19", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "13", "]"}], "-", 
         RowBox[{"e", "[", "19", "]"}]}], ")"}], ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "2", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "8", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "7", "]"}], ",", 
      RowBox[{"e", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "15", "]"}], ",", 
      RowBox[{"e", "[", "18", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "21", "]"}], ",", 
      RowBox[{"e", "[", "24", "]"}]}], "\[IndentingNewLine]", "}"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"PP", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
  3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
  3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
  3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
  3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
  3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
  3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24", ",", "24"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6978694761019*^9, {3.697869592942515*^9, 3.6978696091379004`*^9}, {
   3.6978701168247423`*^9, 3.697870133265419*^9}, 3.697871078522573*^9, 
   3.697871412955618*^9, 3.6978720021544657`*^9, 3.697872152611332*^9, 
   3.697879203153783*^9, 3.6978808235811443`*^9, 3.697890387257553*^9, 
   3.697921725780542*^9, 3.6979574811351624`*^9, 3.697959715169606*^9, 
   3.712043708188395*^9, 3.712049013025836*^9, 3.712058745168447*^9, 
   3.712058904767715*^9, 3.712059028516889*^9, 3.712059152807786*^9, 
   3.712987510703512*^9, 3.713279605342806*^9, 3.714553440804799*^9}],

Cell[BoxData["24"], "Output",
 CellChangeTimes->{
  3.6978694761019*^9, {3.697869592942515*^9, 3.6978696091379004`*^9}, {
   3.6978701168247423`*^9, 3.697870133265419*^9}, 3.697871078522573*^9, 
   3.697871412955618*^9, 3.6978720021544657`*^9, 3.697872152611332*^9, 
   3.697879203153783*^9, 3.6978808235811443`*^9, 3.697890387257553*^9, 
   3.697921725780542*^9, 3.6979574811351624`*^9, 3.697959715169606*^9, 
   3.712043708188395*^9, 3.712049013025836*^9, 3.712058745168447*^9, 
   3.712058904767715*^9, 3.712059028516889*^9, 3.712059152807786*^9, 
   3.712987510703512*^9, 3.713279605342806*^9, 3.714553440817965*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox["gravity", "2"]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", "2"]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6978694761019*^9, {3.697869592942515*^9, 3.6978696091379004`*^9}, {
   3.6978701168247423`*^9, 3.697870133265419*^9}, 3.697871078522573*^9, 
   3.697871412955618*^9, 3.6978720021544657`*^9, 3.697872152611332*^9, 
   3.697879203153783*^9, 3.6978808235811443`*^9, 3.697890387257553*^9, 
   3.697921725780542*^9, 3.6979574811351624`*^9, 3.697959715169606*^9, 
   3.712043708188395*^9, 3.712049013025836*^9, 3.712058745168447*^9, 
   3.712058904767715*^9, 3.712059028516889*^9, 3.712059152807786*^9, 
   3.712987510703512*^9, 3.713279605342806*^9, 3.714553440828661*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.697870151859795*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Similar state matrix (state matrix after similarity transformation)\
\>", "Chapter",
 CellChangeTimes->{
  3.6784537446066513`*^9, {3.678455413121221*^9, 3.678455417246153*^9}, {
   3.713279618434104*^9, 3.713279639657361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Asimilar", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"PP", ".", "A", ".", 
       RowBox[{"Inverse", "[", "PP", "]"}]}], ")"}], "/.", 
     "ParametersSimplification"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Asimilar", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.697870154197797*^9, 3.697870195485117*^9}, {
  3.6978769698458157`*^9, 3.697876983490487*^9}, {3.712043719281135*^9, 
  3.712043720155946*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "kpz"}], 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kpz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"kpz", " ", "L", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx"}], "L"]}], "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6977836177146387`*^9, 3.6978701963044367`*^9, 3.697871078830763*^9, 
   3.6978714131456423`*^9, 3.69787200237407*^9, {3.697872152922316*^9, 
   3.6978721593215*^9}, 3.697876867369138*^9, 3.6978769840532*^9, 
   3.697879207754341*^9, 3.697880823797571*^9, 3.6978903874521303`*^9, 
   3.6979217259969482`*^9, 3.697957481475752*^9, 3.697959715389634*^9, 
   3.7120437208504744`*^9, 3.712049013239768*^9, 3.7120587453059063`*^9, 
   3.712058904853096*^9, 3.712059028605111*^9, 3.7120591528896933`*^9, 
   3.712987511051508*^9, 3.713279644444718*^9, 3.714553441338203*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Characteristic polynomials of controllable-form matrices above have a common \
structure \
\>", "Chapter",
 CellChangeTimes->{{3.712043773180583*^9, 3.7120438100799294`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"structure", " ", "to", " ", "polynomial", " ", "coefficients"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]4", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", " ", "kp"}], ",", 
      RowBox[{"p1", " ", "kv"}], ",", 
      RowBox[{"kp", "+", " ", "p1", " ", "+", "p2"}], " ", ",", " ", "kv"}], 
     "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{"Asimilar", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "8"}], ",", 
        RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "+", 
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["gravity", "L"], ",", 
         RowBox[{
          FractionBox["gravity", "L"], 
          FractionBox[
           RowBox[{" ", "m"}], 
           RowBox[{"2", " ", "M", " "}]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{"Asimilar", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"11", ";;", "14"}], ",", 
        RowBox[{"11", ";;", "14"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "+", 
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["gravity", "L"], ",", 
         RowBox[{
          FractionBox["gravity", "L"], 
          FractionBox[
           RowBox[{" ", "m"}], 
           RowBox[{"2", " ", "M", " "}]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{"Asimilar", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"15", ";;", "18"}], ",", 
        RowBox[{"15", ";;", "18"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "+", 
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox["gravity", "L"], 
          FractionBox[
           RowBox[{
            SuperscriptBox["d", "2"], "  ", "m"}], 
           RowBox[{"J", " "}]]}], ",", 
         RowBox[{
          FractionBox["gravity", "L"], 
          FractionBox[
           RowBox[{" ", "m"}], 
           RowBox[{"2", " ", "M", " "}]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.697876671270461*^9, 3.697876750907806*^9}, {
  3.697876800633458*^9, 3.6978768016906347`*^9}, {3.6978768733575*^9, 
  3.697876937220818*^9}, {3.697877107009254*^9, 3.697877118145797*^9}, {
  3.697879237065778*^9, 3.6978793309165897`*^9}, {3.7120437470072727`*^9, 
  3.712043767456184*^9}, {3.7120438139809837`*^9, 3.712043828655017*^9}, {
  3.712049018414572*^9, 3.7120490937775707`*^9}, {3.713279662149975*^9, 
  3.7132797375677557`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.697876665158668*^9, {3.6978767335535297`*^9, 3.697876751330714*^9}, 
   3.6978768020062*^9, 3.697876940437851*^9, 3.697876988526071*^9, {
   3.69787711865543*^9, 3.697877122801846*^9}, {3.6978792265168867`*^9, 
   3.697879240237315*^9}, 3.69787929113136*^9, {3.697879324225418*^9, 
   3.697879331457*^9}, 3.6978808238374557`*^9, 3.697890387494815*^9, 
   3.697921726028368*^9, 3.6979574815693407`*^9, 3.697959715493869*^9, {
   3.7120437437507153`*^9, 3.71204376235852*^9}, 3.712043830354541*^9, {
   3.7120490942706537`*^9, 3.71204909734519*^9}, 3.712058754372957*^9, 
   3.7120589048990707`*^9, 3.7120590286482*^9, {3.71205915292516*^9, 
   3.712059179207674*^9}, 3.712987511217197*^9, 3.713279657311479*^9, {
   3.7132797379840508`*^9, 3.713279749220643*^9}, 3.714553442075355*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.697876665158668*^9, {3.6978767335535297`*^9, 3.697876751330714*^9}, 
   3.6978768020062*^9, 3.697876940437851*^9, 3.697876988526071*^9, {
   3.69787711865543*^9, 3.697877122801846*^9}, {3.6978792265168867`*^9, 
   3.697879240237315*^9}, 3.69787929113136*^9, {3.697879324225418*^9, 
   3.697879331457*^9}, 3.6978808238374557`*^9, 3.697890387494815*^9, 
   3.697921726028368*^9, 3.6979574815693407`*^9, 3.697959715493869*^9, {
   3.7120437437507153`*^9, 3.71204376235852*^9}, 3.712043830354541*^9, {
   3.7120490942706537`*^9, 3.71204909734519*^9}, 3.712058754372957*^9, 
   3.7120589048990707`*^9, 3.7120590286482*^9, {3.71205915292516*^9, 
   3.712059179207674*^9}, 3.712987511217197*^9, 3.713279657311479*^9, {
   3.7132797379840508`*^9, 3.713279749220643*^9}, 3.714553442089923*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.697876665158668*^9, {3.6978767335535297`*^9, 3.697876751330714*^9}, 
   3.6978768020062*^9, 3.697876940437851*^9, 3.697876988526071*^9, {
   3.69787711865543*^9, 3.697877122801846*^9}, {3.6978792265168867`*^9, 
   3.697879240237315*^9}, 3.69787929113136*^9, {3.697879324225418*^9, 
   3.697879331457*^9}, 3.6978808238374557`*^9, 3.697890387494815*^9, 
   3.697921726028368*^9, 3.6979574815693407`*^9, 3.697959715493869*^9, {
   3.7120437437507153`*^9, 3.71204376235852*^9}, 3.712043830354541*^9, {
   3.7120490942706537`*^9, 3.71204909734519*^9}, 3.712058754372957*^9, 
   3.7120589048990707`*^9, 3.7120590286482*^9, {3.71205915292516*^9, 
   3.712059179207674*^9}, 3.712987511217197*^9, 3.713279657311479*^9, {
   3.7132797379840508`*^9, 3.713279749220643*^9}, 3.714553442098761*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Attitude Control Inner Loop", "Title",
 CellChangeTimes->{{3.677329286790145*^9, 3.677329294501914*^9}, {
   3.677329362966756*^9, 3.6773293712545013`*^9}, {3.712043871379052*^9, 
   3.7120438881282377`*^9}, 3.7132797831185217`*^9}],

Cell["read  za as z_augmented (and xa as x_augmented)", "Subsection",
 CellChangeTimes->{{3.712043890391901*^9, 3.712043911728036*^9}, {
  3.713279790879531*^9, 3.713279791234674*^9}, {3.713279832875054*^9, 
  3.713279844873226*^9}}],

Cell[CellGroupData[{

Cell["UAV angular velocity and force", "Chapter",
 CellChangeTimes->{{3.712043919153522*^9, 3.7120439257656612`*^9}, {
  3.712043956691402*^9, 3.712043961540081*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]r", "[", 
   RowBox[{"r_", ",", "u_"}], "]"}], ":=", 
  RowBox[{"k\[Theta]r", " ", 
   RowBox[{
    RowBox[{"Skew", "[", "r", "]"}], ".", 
    FractionBox["u", 
     SqrtBox[
      RowBox[{"u", ".", "u"}]]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UAVforce", "[", 
   RowBox[{"r_", ",", "u_"}], "]"}], ":=", " ", 
  RowBox[{"r", 
   RowBox[{"(", 
    RowBox[{"r", ".", "u"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Za", "[", 
   RowBox[{"za_", ",", "u_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "24"}], "]"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"UAVforce", "[", 
           RowBox[{"#r1", ",", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"UAVforce", "[", 
           RowBox[{"#r2", ",", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"\[Omega]r", "[", 
         RowBox[{"#r1", ",", 
          RowBox[{"u", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
       "#r1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"\[Omega]r", "[", 
         RowBox[{"#r2", ",", 
          RowBox[{"u", "[", 
           RowBox[{"[", 
            RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
       "#r2"}]}], "\[IndentingNewLine]", "]"}], "&"}], "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<r1\>\"", "\[Rule]", " ", 
      RowBox[{"za", "[", 
       RowBox[{"[", 
        RowBox[{"25", ";;", "27"}], "]"}], "]"}]}], ",", 
     RowBox[{"\"\<r2\>\"", "\[Rule]", " ", 
      RowBox[{"za", "[", 
       RowBox[{"[", 
        RowBox[{"28", ";;", "30"}], "]"}], "]"}]}]}], " ", "|>"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6773293512793913`*^9, 3.677329632197238*^9}, {
   3.6773300407758617`*^9, 3.67733004296955*^9}, 3.677330217155415*^9, {
   3.692542956517262*^9, 3.6925429831406527`*^9}, {3.692543044083296*^9, 
   3.6925432117888412`*^9}, {3.6925432449622498`*^9, 3.6925432800165987`*^9}, 
   3.692544174712475*^9, {3.6925442392240133`*^9, 3.6925442743732557`*^9}, {
   3.692544536506172*^9, 3.692544540524314*^9}, {3.692544709995228*^9, 
   3.69254471102956*^9}, {3.697872739006261*^9, 3.697872743919414*^9}, {
   3.697880297450074*^9, 3.697880297825026*^9}, {3.712043931528882*^9, 
   3.71204415171402*^9}, {3.712044367226288*^9, 3.712044367325893*^9}, {
   3.712045917971253*^9, 3.712045937544847*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["extend previous functions gz2x and gx2z", "Chapter",
 CellChangeTimes->{{3.712044156676034*^9, 3.712044171189101*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zal", "[", "l_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"zl", "[", "l", "]"}], ",", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "20"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"21", ";;", "22"}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "arbitrary", " ", "element", " ", "in", " ", "Za"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xal", "[", "l_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"xl", "[", "l", "]"}], ",", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "20"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"uv3", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"21", ";;", "22"}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "arbitrary", " ", "element", " ", "in", " ", "Xa"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gza2xa", "[", "za_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"gz2x", "[", 
     RowBox[{"za", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "24"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"za", "[", 
     RowBox[{"[", 
      RowBox[{"25", ";;", "30"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gxa2za", "[", "xa_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"gx2z", "[", 
      RowBox[{"xa", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "24"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"xa", "[", 
      RowBox[{"[", 
       RowBox[{"25", ";;", "30"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "functions", " ", "are", " ", "inverse", " ", 
    "of", " ", "each", " ", "other"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "-", 
      RowBox[{"gza2xa", "[", 
       RowBox[{"gxa2za", "[", "#", "]"}], "]"}]}], "&"}], "[", 
    RowBox[{"xal", "[", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "22"}], "]"}], "]"}], 
    "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
       "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "-", 
      RowBox[{"gxa2za", "[", 
       RowBox[{"gza2xa", "[", "#", "]"}], "]"}]}], "&"}], "[", 
    RowBox[{"zal", "[", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "22"}], "]"}], "]"}], 
    "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
       "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.697870648642544*^9, 3.697870784075396*^9}, {
  3.697870894100771*^9, 3.697870896200324*^9}, {3.6978709278649483`*^9, 
  3.697870928737956*^9}, {3.697880217638008*^9, 3.697880273512998*^9}, {
  3.712044182776409*^9, 3.712044235251383*^9}, {3.712044282325502*^9, 
  3.7120443464880133`*^9}, {3.712044467601719*^9, 3.7120445071258917`*^9}, {
  3.7132799112844563`*^9, 3.713279927525773*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.712044507622013*^9, 3.7120459398180323`*^9, 
  3.712049106686657*^9, 3.7120587545131607`*^9, 3.712058904946047*^9, 
  3.712059179367899*^9, 3.7129875113803797`*^9, 3.713279875461351*^9, 
  3.714553467773919*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.712044507622013*^9, 3.7120459398180323`*^9, 
  3.712049106686657*^9, 3.7120587545131607`*^9, 3.712058904946047*^9, 
  3.712059179367899*^9, 3.7129875113803797`*^9, 3.713279875461351*^9, 
  3.714553467790051*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equilibrium in extended domain", "Chapter",
 CellChangeTimes->{{3.7120442630886374`*^9, 3.712044271225418*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zaeq", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"zeq", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xaeq", "=", 
   RowBox[{"gza2xa", "[", "zaeq", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712044239999319*^9, 3.712044257390308*^9}, {
  3.712044633225843*^9, 3.7120446417510147`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check it is equilibrium", "Chapter",
 CellChangeTimes->{{3.7120443770536947`*^9, 3.7120443811002493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Za", "[", 
   RowBox[{"zaeq", ",", "ueq"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{3.712044371813817*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.712044356616312*^9, 3.712044370252792*^9}, 
   3.712045942778845*^9, 3.712049106754508*^9, 3.7120587545741873`*^9, 
   3.71205890500772*^9, 3.712059179428425*^9, 3.712987511567429*^9, 
   3.7132798853597517`*^9, 3.7145534678881693`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["closed loop vector field (same control law as before)", "Chapter",
 CellChangeTimes->{{3.712044431275099*^9, 3.7120444363624907`*^9}, {
  3.712045768419351*^9, 3.712045773232058*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zacl", "[", "z_", "]"}], ":=", 
  RowBox[{"Za", "[", 
   RowBox[{"z", ",", 
    RowBox[{"ucl", "[", 
     RowBox[{"z", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "24"}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zacl", "[", "zaeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.71204441282556*^9, 3.712044425626292*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.712044417826479*^9, 3.712044425886627*^9}, 
   3.712045944114768*^9, 3.712049106786645*^9, 3.7120587546161346`*^9, 
   3.712059179465529*^9, 3.712987511678327*^9, 3.713279891438787*^9, 
   3.7145534679618177`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field in Xa domain", "Chapter",
 CellChangeTimes->{{3.712044587213654*^9, 3.7120445911004143`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"za", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"z", ",", 
     RowBox[{"{", 
      RowBox[{
      "r1x", ",", "r1y", ",", "r1z", ",", "r2x", ",", "r2y", ",", "r2z"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xa", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{
       "r1x", ",", "r1y", ",", "r1z", ",", "r2x", ",", "r2y", ",", "r2z"}], 
       "}"}]}], "]"}]}], ";", 
   RowBox[{
    RowBox[{"Xacl", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",",
        "r2y_", ",", "r2z_"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"gza2xa", "[", "za", "]"}], ",", 
         RowBox[{"{", "za", "}"}]}], "]"}], "]"}], ".", 
      RowBox[{"Zacl", "[", 
       RowBox[{"gxa2za", "[", "xa", "]"}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"za", "\[Rule]", " ", 
       RowBox[{"gxa2za", "[", "xa", "]"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xacl", "[", "xaeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697868258420285*^9, 3.697868544340802*^9}, {
   3.697868576654043*^9, 3.697868827480689*^9}, 3.697869245283223*^9, {
   3.697870938325748*^9, 3.6978709905132*^9}, {3.697871096527279*^9, 
   3.697871129165456*^9}, {3.6978711671016397`*^9, 3.697871171466199*^9}, {
   3.6978713189904623`*^9, 3.697871329630479*^9}, 3.697871433303793*^9, {
   3.6978718733284893`*^9, 3.697871878428203*^9}, 3.6978720592412167`*^9, {
   3.6978723406424417`*^9, 3.697872340929133*^9}, {3.7120445956635237`*^9, 
   3.71204479165867*^9}, {3.712044893852193*^9, 3.71204489570201*^9}, {
   3.7120457107706213`*^9, 3.712045712445068*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.697872062111492*^9, {3.697872319526579*^9, 3.6978723415384607`*^9}, {
   3.6978728160103292`*^9, 3.6978728189567137`*^9}, 3.697879382732235*^9, 
   3.697880824000461*^9, 3.697890387671031*^9, 3.6979217261560097`*^9, 
   3.69795748218486*^9, 3.6979597157387867`*^9, {3.71204474210056*^9, 
   3.712044790123128*^9}, 3.712044896390711*^9, 3.712045753311058*^9, 
   3.712045945731926*^9, 3.712049107052265*^9, 3.712058755045734*^9, 
   3.712059179868319*^9, 3.7129875123859262`*^9, 3.713279898385749*^9, 
   3.714553468547048*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Add stability terms (these do not affect vector field in the domain!)\
\>", "Chapter",
 CellChangeTimes->{{3.712044810027665*^9, 3.712044825416995*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xacl3", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Xacl", "[", "x", "]"}], "+", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"13", ";;", "15"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "21"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"22", ";;", "24"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"25", ";;", "27"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"28", ";;", "30"}], "]"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xacl3", "[", "xaeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697868840056715*^9, 3.6978688523192167`*^9}, {
   3.6978706140388403`*^9, 3.697870623436116*^9}, {3.6978709958143253`*^9, 
   3.6978710431509237`*^9}, 3.697871195778358*^9, {3.712043338949102*^9, 
   3.7120433522746677`*^9}, {3.712044834989312*^9, 3.7120449214048567`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.697868849553028*^9, 3.6978692021033983`*^9, 
  3.6978701064513807`*^9, 3.697870626278841*^9, 3.697872351549995*^9, 
  3.697872406451396*^9, 3.697872822985434*^9, 3.6978793858953733`*^9, 
  3.697880824620829*^9, 3.697890388278986*^9, 3.6979217268032007`*^9, 
  3.6979574829353533`*^9, 3.697959716913268*^9, 3.712044866922007*^9, 
  3.712044922290324*^9, 3.7120453554404507`*^9, 3.712045947406253*^9, 
  3.712049107119966*^9, 3.712058755151737*^9, 3.712059179957068*^9, 
  3.712987512509787*^9, 3.713279941889263*^9, 3.714553468643613*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix", "Chapter",
 CellChangeTimes->{{3.713279952096424*^9, 3.713279953809595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Xacl3", "[", "xa", "]"}], ",", 
         RowBox[{"{", "xa", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"xa", "\[Rule]", " ", "xaeq"}], "]"}]}], "/.", 
      "ParametersSimplification"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]px", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vx", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]py", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vy", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]pz", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vz", ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.697868867188023*^9, 3.6978689376077003`*^9}, {
   3.697869060394891*^9, 3.69786908876962*^9}, {3.697869212884316*^9, 
   3.697869213358185*^9}, 3.6978696398213882`*^9, {3.697871242892275*^9, 
   3.697871248989636*^9}, {3.6978724194567204`*^9, 3.697872443505158*^9}, {
   3.7120449307027903`*^9, 3.712044981190736*^9}, {3.712058757942931*^9, 
   3.7120587780306053`*^9}, {3.7120591835948668`*^9, 3.712059191473528*^9}, 
   3.7132799561869707`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", 
      RowBox[{"-", "kpz"}], "0", "0", 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0", "0", "0", 
      "gravity", "0", "0", "gravity"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", "kpz", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "-", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.712044989684021*^9, 3.712045363073965*^9, 
  3.712045956389368*^9, 3.712049114265835*^9, 3.712058789961589*^9, 
  3.7120592082809362`*^9, 3.7129875328251257`*^9, 3.713279975337682*^9, 
  3.714553486102591*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"30", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PP", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ".", "A"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "9", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "9", "]"}], ".", "A"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", "13", "]"}], "-", 
       RowBox[{"e", "[", "19", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "13", "]"}], "-", 
         RowBox[{"e", "[", "19", "]"}]}], ")"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "13", "]"}], "-", 
         RowBox[{"e", "[", "19", "]"}]}], ")"}], ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "2", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "8", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "7", "]"}], ",", 
      RowBox[{"e", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "15", "]"}], ",", 
      RowBox[{"e", "[", "18", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "21", "]"}], ",", 
      RowBox[{"e", "[", "24", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "27", "]"}], ",", 
      RowBox[{"e", "[", "30", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"terms", " ", "r1z", " ", "and", " ", 
        RowBox[{"r2z", ":", " ", 
         RowBox[{"linearization", " ", "r1zdot"}]}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{"0", " ", "and", " ", "r2zdot"}], " ", "=", " ", "0"}]}], 
      "*)"}], "\[IndentingNewLine]", "}"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"PP", "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
  3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
  3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
  3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
  3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
  3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
  3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
  3.7120450230059137`*^9, 3.712045143320734*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", "30"}], "}"}]], "Output",
 CellChangeTimes->{{3.712045113722734*^9, 3.712045144169648*^9}, 
   3.712045313113*^9, 3.712045367479536*^9, 3.712045419956476*^9, 
   3.7120459599126577`*^9, 3.712049114363497*^9, 3.712058793446602*^9, 
   3.712059208342928*^9, 3.7129875330177383`*^9, 3.713279975460022*^9, 
   3.714553486223153*^9}],

Cell[BoxData["30"], "Output",
 CellChangeTimes->{{3.712045113722734*^9, 3.712045144169648*^9}, 
   3.712045313113*^9, 3.712045367479536*^9, 3.712045419956476*^9, 
   3.7120459599126577`*^9, 3.712049114363497*^9, 3.712058793446602*^9, 
   3.712059208342928*^9, 3.7129875330177383`*^9, 3.713279975460022*^9, 
   3.714553486237493*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["A  matrix: after similarity transformation", "Chapter",
 CellChangeTimes->{{3.712045149627686*^9, 3.712045162265546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"PP", ".", "A", ".", 
       RowBox[{"Inverse", "[", "PP", "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PP", ".", "A", ".", 
         RowBox[{"Inverse", "[", "PP", "]"}]}], ")"}], ",", 
       RowBox[{
        RowBox[{"gravity", ">", "0"}], " ", "&&", " ", 
        RowBox[{"M", ">", "0"}], "&&", 
        RowBox[{"m", ">", "0"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Asimilar", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.69787253396821*^9, 3.6978725370671787`*^9}, {
  3.6978726142932997`*^9, 3.697872631268517*^9}, {3.697874959504425*^9, 
  3.6978749791920137`*^9}, {3.712045168603406*^9, 3.712045269153802*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {
      RowBox[{"-", "kpz"}], 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "gravity", "gravity"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kpz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"kpz", " ", "L", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kvx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "2", " ", "J", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
         "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6978725386362743`*^9, 3.697872632316728*^9, 3.6978728450736837`*^9, 
   3.697874980074792*^9, 3.697877249157168*^9, 3.697879407687258*^9, 
   3.6978795219971647`*^9, 3.6978808357978973`*^9, 3.697890399649765*^9, 
   3.6979217395719023`*^9, 3.697957495360272*^9, 3.697959730196928*^9, {
   3.71204522129985*^9, 3.712045269615758*^9}, 3.712045316508154*^9, 
   3.712045370723321*^9, 3.712045962017784*^9, 3.712049114640749*^9, 
   3.712058796299926*^9, 3.712059208543537*^9, 3.712987533579028*^9, 
   3.7132799827571077`*^9, 3.714553486623349*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["system of 3rd order", "Chapter",
 CellChangeTimes->{{3.712046115930859*^9, 3.712046119405333*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p3", " ", 
     RowBox[{"(", 
      RowBox[{"kp", "+", "p2"}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p3", " ", "kd"}], "+", " ", "p2"}], " ", ",", "p3"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{"Asimilar", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"10", ";;", "12"}], ",", 
      RowBox[{"10", ";;", "12"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AofInterest", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "+", 
   RowBox[{"\[CapitalGamma]3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["gravity", "L"], ",", 
       RowBox[{
        FractionBox["gravity", "L"], 
        FractionBox[
         RowBox[{" ", "m"}], 
         RowBox[{"2", " ", "M", " "}]]}], ",", "k\[Theta]r"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7120461072681417`*^9, 3.712046112432177*^9}, {
  3.712046144205703*^9, 3.7120461456184397`*^9}, {3.712046199119089*^9, 
  3.7120462273806877`*^9}, {3.712046257968032*^9, 3.712046292680724*^9}, {
  3.712046329433709*^9, 3.712046423718479*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712046290814867*^9, {3.712046370993122*^9, 3.712046424953437*^9}, 
   3.712049114687752*^9, {3.7120588021895943`*^9, 3.712058814954838*^9}, 
   3.712059208589671*^9, 3.712987533731061*^9, 3.713279997224613*^9, 
   3.714553486716783*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["systems of 5th order", "Chapter",
 CellChangeTimes->{{3.7120461272805777`*^9, 3.712046134118257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p3", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", " ", "kp"}], ",", 
       RowBox[{"p1", " ", "kv"}], ",", 
       RowBox[{"kp", "+", " ", "p1", " ", "+", "p2"}], " ", ",", "kv", ",", 
       "0"}], "}"}]}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{"p1", "+", "p2"}], ",", "p3"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{"Asimilar", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"5", ";;", "9"}], ",", 
      RowBox[{"5", ";;", "9"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AofInterest", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "+", 
   RowBox[{"\[CapitalGamma]5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["gravity", "L"], ",", 
       RowBox[{
        FractionBox["gravity", "L"], 
        FractionBox[
         RowBox[{" ", "m"}], 
         RowBox[{"2", " ", "M", " "}]]}], ",", "k\[Theta]r"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{"Asimilar", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"13", ";;", "17"}], ",", 
      RowBox[{"13", ";;", "17"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AofInterest", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "+", 
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["gravity", "L"], ",", 
        RowBox[{
         FractionBox["gravity", "L"], 
         FractionBox[
          RowBox[{" ", "m"}], 
          RowBox[{"2", " ", "M", " "}]]}], ",", "k\[Theta]r"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{"Asimilar", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"18", ";;", "22"}], ",", 
      RowBox[{"18", ";;", "22"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AofInterest", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "+", 
   RowBox[{"\[CapitalGamma]5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["gravity", "L"], 
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "2"], "  ", "m"}], 
         RowBox[{"J", " "}]]}], ",", 
       RowBox[{
        FractionBox["gravity", "L"], 
        FractionBox[
         RowBox[{" ", "m"}], 
         RowBox[{"2", " ", "M", " "}]]}], ",", "k\[Theta]r"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697876671270461*^9, 3.697876750907806*^9}, {
  3.697876800633458*^9, 3.6978768016906347`*^9}, {3.697877358409115*^9, 
  3.697877369134095*^9}, {3.697879441402993*^9, 3.697879496664921*^9}, {
  3.697879532191098*^9, 3.697879546578685*^9}, {3.6978903397071133`*^9, 
  3.6978903492944603`*^9}, {3.6978905138711233`*^9, 3.697890514024*^9}, {
  3.712045578832144*^9, 3.7120455896312037`*^9}, {3.71204605430892*^9, 
  3.7120460590937233`*^9}, {3.712046094873621*^9, 3.7120461045434837`*^9}, {
  3.7120464311450253`*^9, 3.712046541081126*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712045968469393*^9, 3.712046060136627*^9, 3.7120461385926332`*^9, {
   3.712046532472633*^9, 3.7120465391580353`*^9}, 3.712049114720418*^9, 
   3.712058802250904*^9, 3.712059211249501*^9, 3.7129875338622828`*^9, 
   3.713280000769106*^9, 3.7145534867833023`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712045968469393*^9, 3.712046060136627*^9, 3.7120461385926332`*^9, {
   3.712046532472633*^9, 3.7120465391580353`*^9}, 3.712049114720418*^9, 
   3.712058802250904*^9, 3.712059211249501*^9, 3.7129875338622828`*^9, 
   3.713280000769106*^9, 3.7145534867989607`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712045968469393*^9, 3.712046060136627*^9, 3.7120461385926332`*^9, {
   3.712046532472633*^9, 3.7120465391580353`*^9}, 3.712049114720418*^9, 
   3.712058802250904*^9, 3.712059211249501*^9, 3.7129875338622828`*^9, 
   3.713280000769106*^9, 3.714553486809288*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integral action: mass of bar is known", "Title",
 CellChangeTimes->{{3.677329645783099*^9, 3.6773296482196207`*^9}, {
  3.697879647391728*^9, 3.697879651366317*^9}, {3.7120466805183077`*^9, 
  3.712046687768373*^9}, {3.713280041680567*^9, 3.7132800587840242`*^9}}],

Cell[CellGroupData[{

Cell["control law with integral action when mass is known", "Chapter",
 CellChangeTimes->{{3.713332654471348*^9, 3.713332666464562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uclIntegral", "[", "zaInt_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ucl", "[", 
    RowBox[{"zaInt", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "24"}], "]"}], "]"}], "]"}], "-", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m1", "+", 
        FractionBox["m", "2"]}], ")"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"kiz", " ", 
         RowBox[{"zaInt", "[", 
          RowBox[{"[", "31", "]"}], "]"}]}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m2", "+", 
        FractionBox["m", "2"]}], ")"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"kiz", " ", 
         RowBox[{"zaInt", "[", 
          RowBox[{"[", "32", "]"}], "]"}]}]}], "}"}]}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.712046887644606*^9, 3.712046888666667*^9}, 
   3.7120473779470873`*^9, {3.713332679577036*^9, 3.713332680398193*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extended vector field", "Chapter",
 CellChangeTimes->{{3.71333271122622*^9, 3.713332717310409*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZaIntegral", "[", "zaInt_", "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Za", "[", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "30"}], "]"}], "]"}], ",", 
      RowBox[{"uclIntegral", "[", "zaInt", "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", "9", "]"}], "]"}], "-", 
      RowBox[{"zeq", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", "12", "]"}], "]"}], "-", 
      RowBox[{"zeq", "[", 
       RowBox[{"[", "12", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extended equilibrium", "Chapter",
 CellChangeTimes->{{3.713332723152226*^9, 3.713332727983099*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zaInteq", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"zaeq", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZaIntegral", "[", "zaInteq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{3.713332691638328*^9, 3.71333272944839*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.713332734845417*^9, 3.714553494521101*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extend functions gx2z and gz2x", "Chapter",
 CellChangeTimes->{{3.713332741894703*^9, 3.7133327540625343`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zaInt", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"za", ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]1", ",", "\[Xi]2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xaInt", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"xa", ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]1", ",", "\[Xi]2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gzaInt2xaInt", "[", "zaInt_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"gza2xa", "[", 
     RowBox[{"zaInt", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "30"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"zaInt", "[", 
     RowBox[{"[", 
      RowBox[{"31", ";;", "32"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gxaInt2zaInt", "[", "xaInt_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"gxa2za", "[", 
     RowBox[{"xaInt", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "30"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"xaInt", "[", 
     RowBox[{"[", 
      RowBox[{"31", ";;", "32"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.712047187537162*^9, 3.7120472221580667`*^9}, {
  3.713332761328885*^9, 3.713332766845017*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field in extended X domain", "Chapter",
 CellChangeTimes->{{3.713332770367675*^9, 3.713332781769939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XaInt", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",",
        "r2y_", ",", "r2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"gzaInt2xaInt", "[", "zaInt", "]"}], ",", 
         RowBox[{"{", "zaInt", "}"}]}], "]"}], "]"}], ".", 
      RowBox[{"ZaIntegral", "[", 
       RowBox[{"gxaInt2zaInt", "[", "xaInt", "]"}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"zaInt", "\[Rule]", " ", 
       RowBox[{"gxaInt2zaInt", "[", "xaInt", "]"}]}], "]"}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.713332793514215*^9, 3.713332793980179*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibrium in extended X domain", "Chapter",
 CellChangeTimes->{{3.713332797332541*^9, 3.7133328060742064`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xaInteq", "=", 
   RowBox[{"gzaInt2xaInt", "[", "zaInteq", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaInt", "[", "xaInteq", "]"}], "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7133328072158422`*^9, 3.714553495298645*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field with stability vector field", "Chapter",
 CellChangeTimes->{{3.713332810311146*^9, 3.713332820989361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"XaInt3", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"XaInt", "[", "x", "]"}], "+", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"13", ";;", "15"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "21"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"22", ";;", "24"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"25", ";;", "27"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"28", ";;", "30"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.712046891325303*^9, 3.7120471691739693`*^9}, {
  3.7120472060829277`*^9, 3.712047252596034*^9}, {3.712047385633761*^9, 
  3.7120473858095217`*^9}, {3.7120592209951982`*^9, 3.712059231344962*^9}, {
  3.713332832292227*^9, 3.713332832607141*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix", "Chapter",
 CellChangeTimes->{{3.713332837654566*^9, 3.713332841792643*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"XaInt3", "[", "xaInt", "]"}], ",", 
         RowBox[{"{", "xaInt", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"xaInt", "\[Rule]", " ", "xaInteq"}], "]"}]}], "/.", 
      "ParametersSimplification"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]px", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vx", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]py", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vy", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]pz", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vz", ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "kpz"}], "0", "0", 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"kpz", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], "0", "0", "0", "0", "0", 
      "gravity", "0", "0", "gravity", 
      RowBox[{"-", 
       FractionBox["kiz", "2"]}], 
      RowBox[{"-", 
       FractionBox["kiz", "2"]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", "kpz", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "-", 
          RowBox[{"kpz", " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      FractionBox[
       RowBox[{"d", " ", "kiz", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kiz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "d", "0", "0", "0", "0", "0", 
      "L", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", 
      RowBox[{"-", "d"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "L", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.713332864118123*^9, 3.714553514917809*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"32", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PP", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ".", "A"}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"e", "[", "9", "]"}], ",", 
       RowBox[{
        RowBox[{"e", "[", "9", "]"}], ".", "A"}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "31", "]"}], "+", 
       RowBox[{"e", "[", "32", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "+", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "+", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", "31", "]"}], "-", 
       RowBox[{"e", "[", "32", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "-", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "-", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", "13", "]"}], "-", 
       RowBox[{"e", "[", "19", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "13", "]"}], "-", 
         RowBox[{"e", "[", "19", "]"}]}], ")"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "13", "]"}], "-", 
         RowBox[{"e", "[", "19", "]"}]}], ")"}], ".", "A", ".", "A"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "[", "2", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "8", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "8", "]"}], ".", "A", ".", "A", ".", "A", ".", "A"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "7", "]"}], ",", 
      RowBox[{"e", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "15", "]"}], ",", 
      RowBox[{"e", "[", "18", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "21", "]"}], ",", 
      RowBox[{"e", "[", "24", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"e", "[", "27", "]"}], ",", 
      RowBox[{"e", "[", "30", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"terms", " ", "r1z", " ", "and", " ", 
        RowBox[{"r2z", ":", " ", 
         RowBox[{"linearization", " ", "r1zdot"}]}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{"0", " ", "and", " ", "r2zdot"}], " ", "=", " ", "0"}]}], 
      "*)"}], "\[IndentingNewLine]", "}"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"PP", "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
  3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
  3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
  3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
  3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
  3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
  3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
  3.7120450230059137`*^9, 3.712045143320734*^9}, {3.712047292561651*^9, 
  3.712047345109585*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{{3.712045113722734*^9, 3.712045144169648*^9}, 
   3.712045313113*^9, 3.712045367479536*^9, 3.712045419956476*^9, 
   3.7120459599126577`*^9, 3.712047352596252*^9, 3.712047394794742*^9, 
   3.712049122265998*^9, 3.712059246610395*^9, {3.712987558168666*^9, 
   3.712987561565929*^9}, 3.714553515156199*^9}],

Cell[BoxData["32"], "Output",
 CellChangeTimes->{{3.712045113722734*^9, 3.712045144169648*^9}, 
   3.712045313113*^9, 3.712045367479536*^9, 3.712045419956476*^9, 
   3.7120459599126577`*^9, 3.712047352596252*^9, 3.712047394794742*^9, 
   3.712049122265998*^9, 3.712059246610395*^9, {3.712987558168666*^9, 
   3.712987561565929*^9}, 3.71455351516886*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpreation for Pz", "Chapter",
 CellChangeTimes->{{3.712987674507326*^9, 3.712987680738802*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AAUX", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"XaInt3", "[", "xaInt", "]"}], ",", 
         RowBox[{"{", "xaInt", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"xaInt", "\[Rule]", " ", "xaInteq"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]px", ">", "0"}], "&&", 
       RowBox[{"\[Sigma]vx", ">", "0"}], "&&", 
       RowBox[{"\[Sigma]py", ">", "0"}], "&&", 
       RowBox[{"\[Sigma]vy", ">", "0"}], "&&", 
       RowBox[{"\[Sigma]pz", ">", "0"}], "&&", 
       RowBox[{"\[Sigma]vz", ">", "0"}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["d2", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
          RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
         RowBox[{
          FractionBox["d1", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
          RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "xaInt"}], "//", 
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["d2", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
           RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
           RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "AAUX", ".", 
        "xaInt"}]}]}], "//", 
     RowBox[{
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["d2", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
           RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
           RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "AAUX", ".", "AAUX",
         ".", "xaInt"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}], "}"}]}]}], "//", 
    "Simplify"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.713333089035129*^9, 3.713333115904352*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"e", "[", "31", "]"}], "+", " ", 
     RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "xaInt"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"e", "[", "31", "]"}], "+", " ", 
     RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "xaInt"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"e", "[", "31", "]"}], "+", " ", 
      RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A", ".", 
    "xaInt"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712987504541882*^9, 3.712987531415716*^9}, {
  3.712987591574101*^9, 3.712987594222632*^9}, {3.712987636856511*^9, 
  3.7129876651724*^9}, {3.712987702106976*^9, 3.712987705038541*^9}, {
  3.712987808722785*^9, 3.712987929883419*^9}, {3.712988058112996*^9, 
  3.712988075327549*^9}, {3.713332889263006*^9, 3.713332899642826*^9}, {
  3.7133329355327387`*^9, 3.713332938280208*^9}, {3.713332974561998*^9, 
  3.713332979223537*^9}, {3.713333010100206*^9, 3.713333110385394*^9}}],

Cell[BoxData[
 RowBox[{"\[Xi]1", "+", "\[Xi]2"}]], "Output",
 CellChangeTimes->{
  3.712987703118712*^9, {3.712987837153222*^9, 3.712987898193235*^9}, 
   3.7129879303131847`*^9, 3.71333293868773*^9, 3.713332980452392*^9, 
   3.7133330450327787`*^9, 3.71333307649435*^9, 3.71333311107096*^9, 
   3.7145535153358707`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", 
   RowBox[{"(", 
    RowBox[{"n1z", "+", "n2z"}], ")"}]}], "+", 
  RowBox[{"2", " ", "pz"}]}]], "Output",
 CellChangeTimes->{
  3.712987703118712*^9, {3.712987837153222*^9, 3.712987898193235*^9}, 
   3.7129879303131847`*^9, 3.71333293868773*^9, 3.713332980452392*^9, 
   3.7133330450327787`*^9, 3.71333307649435*^9, 3.71333311107096*^9, 
   3.714553515348778*^9}],

Cell[BoxData[
 RowBox[{"2", " ", "vz"}]], "Output",
 CellChangeTimes->{
  3.712987703118712*^9, {3.712987837153222*^9, 3.712987898193235*^9}, 
   3.7129879303131847`*^9, 3.71333293868773*^9, 3.713332980452392*^9, 
   3.7133330450327787`*^9, 3.71333307649435*^9, 3.71333311107096*^9, 
   3.714553515357411*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpreation for P\[Theta]", "Chapter",
 CellChangeTimes->{{3.712987691149062*^9, 3.7129876980407352`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"e", "[", "31", "]"}], "-", " ", 
          RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "xaInt"}]}], "//", 
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       FractionBox["1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"e", "[", "31", "]"}], "-", " ", 
          RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "AAUX", ".", 
        "xaInt"}]}]}], "//", 
     RowBox[{
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       FractionBox["1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"e", "[", "31", "]"}], "-", " ", 
          RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "AAUX", ".", "AAUX", 
        ".", "xaInt"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}], "}"}]}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"e", "[", "31", "]"}], "-", " ", 
       RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "xaInt"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"e", "[", "31", "]"}], "-", " ", 
       RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "xaInt"}], "//",
     "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A", ".", 
      "xaInt"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}], "}"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.7129879499073467`*^9, 3.712988066713093*^9}, {
  3.713333122997099*^9, 3.71333315324082*^9}}],

Cell[BoxData[
 RowBox[{"\[Xi]1", "-", "\[Xi]2"}]], "Output",
 CellChangeTimes->{
  3.7129877172628803`*^9, {3.712987962036372*^9, 3.712988038162079*^9}, {
   3.713333119442892*^9, 3.713333154055872*^9}, 3.714553515445549*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", 
   RowBox[{"(", 
    RowBox[{"n1z", "-", "n2z"}], ")"}]}], "+", 
  RowBox[{"2", " ", "d", " ", "nz"}]}]], "Output",
 CellChangeTimes->{
  3.7129877172628803`*^9, {3.712987962036372*^9, 3.712988038162079*^9}, {
   3.713333119442892*^9, 3.713333154055872*^9}, 3.7145535154609003`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "d", " ", "\[Omega]y"}]], "Output",
 CellChangeTimes->{
  3.7129877172628803`*^9, {3.712987962036372*^9, 3.712988038162079*^9}, {
   3.713333119442892*^9, 3.713333154055872*^9}, 3.7145535154724607`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["state matrix: after similarity transformation", "Chapter",
 CellChangeTimes->{{3.712045149627686*^9, 3.712045162265546*^9}, {
  3.713333174970284*^9, 3.71333317668743*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"PP", ".", "A", ".", 
       RowBox[{"Inverse", "[", "PP", "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PP", ".", "A", ".", 
         RowBox[{"Inverse", "[", "PP", "]"}]}], ")"}], ",", 
       RowBox[{
        RowBox[{"gravity", ">", "0"}], " ", "&&", " ", 
        RowBox[{"M", ">", "0"}], "&&", 
        RowBox[{"m", ">", "0"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Asimilar", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.69787253396821*^9, 3.6978725370671787`*^9}, {
  3.6978726142932997`*^9, 3.697872631268517*^9}, {3.697874959504425*^9, 
  3.6978749791920137`*^9}, {3.712045168603406*^9, 3.712045269153802*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", "kiz"}], 
      RowBox[{"-", "kpz"}], 
      RowBox[{"-", "kvz"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"kvz", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"kvz", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", 
      RowBox[{"2", " ", "gravity"}], 
      RowBox[{"2", " ", "gravity"}]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kiz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kpz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      FractionBox[
       RowBox[{
        RowBox[{"J", " ", "L", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "J"}], " ", "L", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz", " ", "m"}], "+", 
              RowBox[{"2", " ", "kvz", " ", "M"}], "-", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kvx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "2", " ", "J", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
         "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7120473672487383`*^9, 3.712047398522624*^9, 
  3.712049122369316*^9, 3.7120592525509987`*^9, 3.713333179359556*^9, 
  3.714553515741252*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integral action: mass of load is not", "Title",
 CellChangeTimes->{{3.677329645783099*^9, 3.6773296482196207`*^9}, {
   3.697879647391728*^9, 3.697879651366317*^9}, {3.697921775683827*^9, 
   3.697921775905059*^9}, {3.712047527471307*^9, 3.7120475328091993`*^9}, 
   3.713280055765353*^9}],

Cell[CellGroupData[{

Cell["control law with integral action when mass is known", "Chapter",
 CellChangeTimes->{{3.713332654471348*^9, 3.713332666464562*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u1clInt", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",",
        "r2y_", ",", "r2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], 
    "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"ux", "[", 
        RowBox[{
         RowBox[{"p1x", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{"v1x", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "16", "]"}], "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"m1", " ", 
       RowBox[{"uy", "[", 
        RowBox[{
         RowBox[{"p1y", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{"v1y", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "17", "]"}], "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"m1", "  ", 
       RowBox[{"uz", "[", 
        RowBox[{
         RowBox[{"p1z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}], ",", 
         RowBox[{"v1z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "18", "]"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u2clInt", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",",
        "r2y_", ",", "r2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], 
    "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", " ", 
       RowBox[{"ux", "[", 
        RowBox[{
         RowBox[{"p2x", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "10", "]"}], "]"}]}], ",", 
         RowBox[{"v2x", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "22", "]"}], "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"m2", " ", 
       RowBox[{"uy", "[", 
        RowBox[{
         RowBox[{"p2y", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "11", "]"}], "]"}]}], ",", 
         RowBox[{"v2y", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "23", "]"}], "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"m2", " ", 
       RowBox[{"uz", "[", 
        RowBox[{
         RowBox[{"p2z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "12", "]"}], "]"}]}], ",", 
         RowBox[{"v2z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "24", "]"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ueqInt", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"m1", " ", "gravity"}], " ", ",", "0", ",", "0", ",", 
      RowBox[{"m2", " ", "gravity"}]}], " ", "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "x_", "]"}], ":=", 
    FractionBox[
     RowBox[{"\[Sigma]\[Sigma]", " ", "x"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[Sigma]\[Sigma]", "2"], "+", 
       SuperscriptBox["x", "2"]}]]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Sigma]inv", "[", "y_", "]"}], ":=", 
    FractionBox[
     RowBox[{"y", " ", "\[Sigma]\[Sigma]"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["y", "2"]}], "+", 
       SuperscriptBox["\[Sigma]\[Sigma]", "2"]}]]]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uclIntegral", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
      "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1_", ",", 
      "\[Xi]2_"}], "}"}], "]"}], "=", 
   RowBox[{"ueqInt", " ", "+", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"u1clInt", "[", "zaInt", "]"}], ",", 
      RowBox[{"u2clInt", "[", "zaInt", "]"}]}], "]"}], "-", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"kiz", " ", "\[Xi]1"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"m2", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", " ", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"kiz", " ", "\[Xi]2"}], "]"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.697879685491702*^9, 3.697879763253832*^9}, {
   3.6978798213422422`*^9, 3.69787996497812*^9}, {3.6978808511013517`*^9, 
   3.697880854098817*^9}, {3.6978815949675922`*^9, 3.697881595277157*^9}, {
   3.697921781754732*^9, 3.6979218471948347`*^9}, {3.6979218971226*^9, 
   3.6979219425333*^9}, {3.697921975934677*^9, 3.697922000944689*^9}, {
   3.697922072570332*^9, 3.697922074901041*^9}, {3.697923260119748*^9, 
   3.697923409316148*^9}, {3.697923490255422*^9, 3.6979234903970537`*^9}, {
   3.697957598076315*^9, 3.6979576065871553`*^9}, 3.697957802900566*^9, {
   3.697958057734694*^9, 3.6979580684862633`*^9}, {3.69795955398995*^9, 
   3.697959560026952*^9}, {3.697960927551272*^9, 3.6979609342743387`*^9}, {
   3.71204016132274*^9, 3.712040170180977*^9}, {3.712040226424169*^9, 
   3.712040307036985*^9}, {3.7120475374349203`*^9, 3.7120475763972588`*^9}, {
   3.712047613200474*^9, 3.712047656072852*^9}, {3.712047703685604*^9, 
   3.71204774502324*^9}, {3.712048083862523*^9, 3.712048138012401*^9}, 
   3.712058416066839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extended vector field", "Chapter",
 CellChangeTimes->{{3.71333271122622*^9, 3.713332717310409*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZaIntegral", "[", "zaInt_", "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Za", "[", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "30"}], "]"}], "]"}], ",", 
      RowBox[{"uclIntegral", "[", "zaInt", "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", "9", "]"}], "]"}], "-", 
      RowBox[{"zeq", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zaInt", "[", 
       RowBox[{"[", "12", "]"}], "]"}], "-", 
      RowBox[{"zeq", "[", 
       RowBox[{"[", "12", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extended equilibrium", "Chapter",
 CellChangeTimes->{{3.713332723152226*^9, 3.713332727983099*^9}}],

Cell[CellGroupData[{

Cell["in this situation, integral equilibrium is non-zero", "Subchapter",
 CellChangeTimes->{3.71333329076556*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zaInteq", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"zaeq", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "kiz"], 
        RowBox[{
         RowBox[{"InverseFunction", "[", "\[Sigma]", "]"}], "[", " ", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"d2", " ", "gravity", " ", "m"}], 
            RowBox[{"d2", "-", "d1"}]]}], " ", 
          FractionBox["1", "m1"]}], "]"}]}], ",", " ", 
       RowBox[{
        FractionBox["1", "kiz"], 
        RowBox[{
         RowBox[{"InverseFunction", "[", "\[Sigma]", "]"}], "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"d1", " ", "gravity", " ", "m"}], 
            RowBox[{"d1", "-", "d2"}]]}], 
          FractionBox["1", 
           RowBox[{" ", "m2"}]]}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uclIntegral", "[", "zaInteq", "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZaIntegral", "[", "zaInteq", "]"}], "//", 
  "FullSimplify"}]}], "Input"],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,161,1,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7133332938100367`*^9, 3.714553523690073*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,161,2,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7133332938100367`*^9, 3.714553523710959*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"gravity", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"d2", " ", "m"}], 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "+", "m1"}], ")"}]}], ",", "0", 
   ",", "0", ",", 
   RowBox[{"gravity", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"d1", " ", "m"}], 
       RowBox[{"d1", "-", "d2"}]], "+", "m2"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.713333293840407*^9, 3.71455352373097*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,162,3,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7133332938100367`*^9, 3.714553523740076*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,162,4,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7133332938100367`*^9, 3.71455352376048*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.713333293840407*^9, 3.7145535237809362`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extend functions gx2z and gz2x", "Chapter",
 CellChangeTimes->{{3.713332741894703*^9, 3.7133327540625343`*^9}}],

Cell["same as before: no need to define them again", "Subchapter",
 CellChangeTimes->{{3.7133333128552523`*^9, 3.7133333230171013`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field in extended X domain", "Chapter",
 CellChangeTimes->{{3.713332770367675*^9, 3.713332781769939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XaInt", "[", 
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
       "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", 
       "\[Omega]1x_", ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", 
       ",", "n2y_", ",", "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", 
       "\[Omega]2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",",
        "r2y_", ",", "r2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"gzaInt2xaInt", "[", "zaInt", "]"}], ",", 
         RowBox[{"{", "zaInt", "}"}]}], "]"}], "]"}], ".", 
      RowBox[{"ZaIntegral", "[", 
       RowBox[{"gxaInt2zaInt", "[", "xaInt", "]"}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"zaInt", "\[Rule]", " ", 
       RowBox[{"gxaInt2zaInt", "[", "xaInt", "]"}]}], "]"}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.713333335373671*^9, 3.713333336597452*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibrium in extended X domain", "Chapter",
 CellChangeTimes->{{3.713332797332541*^9, 3.7133328060742064`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xaInteq", "=", 
   RowBox[{"gzaInt2xaInt", "[", "zaInteq", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaInt", "[", "xaInteq", "]"}], "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,165,5,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.714553525216424*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,165,6,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.714553525574051*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,165,7,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7145535258792267`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"InverseFunction\\\", \\\
\"::\\\", \\\"ifun\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,165,8,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.714553526219883*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.714553526290135*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field with stability vector field", "Chapter",
 CellChangeTimes->{{3.713332810311146*^9, 3.713332820989361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"XaInt3", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"XaInt", "[", "x", "]"}], "+", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"13", ";;", "15"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n\[Omega]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"19", ";;", "21"}], "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"22", ";;", "24"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"25", ";;", "27"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]n", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"28", ";;", "30"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix", "Chapter",
 CellChangeTimes->{{3.713332837654566*^9, 3.713332841792643*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"XaInt3", "[", "xaInt", "]"}], ",", 
         RowBox[{"{", "xaInt", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"xaInt", "\[Rule]", " ", "xaInteq"}], "]"}]}], "/.", 
      "ParametersSimplification"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]px", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vx", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]py", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vy", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]pz", ">", "0"}], "&&", 
      RowBox[{"\[Sigma]vz", ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712046891325303*^9, 3.7120471691739693`*^9}, {
  3.7120472060829277`*^9, 3.712047252596034*^9}, {3.712047385633761*^9, 
  3.7120473858095217`*^9}, {3.712059264707605*^9, 3.71205927483397*^9}, {
  3.7133333429678392`*^9, 3.713333351336378*^9}}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,167,9,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.71204821119552*^9, 3.71204912978953*^9, 
  3.712059292414709*^9, 3.713333375670553*^9, 3.71455354344036*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,167,10,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.71204821119552*^9, 3.71204912978953*^9, 
  3.712059292414709*^9, 3.713333375670553*^9, 3.714553544177846*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,167,11,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.71204821119552*^9, 3.71204912978953*^9, 
  3.712059292414709*^9, 3.713333375670553*^9, 3.7145535448585453`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"InverseFunction\\\", \\\
\"::\\\", \\\"ifun\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,167,12,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.71204821119552*^9, 3.71204912978953*^9, 
  3.712059292414709*^9, 3.713333375670553*^9, 3.714553545395975*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", 
      FractionBox["gravity", "2"], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "kpz"}], " ", "L", " ", "M"}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "kpz"}], " ", "L", " ", "M"}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", "0", "0", "0", "0", "gravity", "0", 
      "0", "gravity", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kiz", " ", "M", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gravity", " ", "m"}], 
             RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kiz", " ", "M", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gravity", " ", "m"}], 
             RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz"}], " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpz"}], " ", "L", " ", "M"}], "+", 
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      FractionBox[
       RowBox[{"d", " ", "kiz", " ", "M", " ", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "\[Prime]",
          MultilineFunction->None], "[", 
         RowBox[{
          TagBox[
           SuperscriptBox["\[Sigma]", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           InverseFunction,
           Editable->False], "[", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"gravity", " ", "m"}], 
            RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kiz", " ", "M", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gravity", " ", "m"}], 
             RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "J"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m"}], 
        RowBox[{"2", " ", "J"}]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L"}]], "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", "L", " ", "M"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", 
        RowBox[{"2", " ", "L"}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kvy", " ", "k\[Theta]r", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["gravity", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]], "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], "2"]}]]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "d", "0", "0", "0", "0", "0", 
      "L", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", 
      RowBox[{"-", "d"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "L", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7120482133037663`*^9, 3.7120491314930077`*^9, 
  3.712059295380274*^9, 3.713333380635524*^9, 3.714553548082423*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.7133333670689287`*^9, 3.7133333725579233`*^9}}],

Cell["same as before, no need to redefine it again", "Subchapter",
 CellChangeTimes->{{3.71333337455389*^9, 3.713333384643888*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A  matrix: after similarity transformation (same similarity matrix as before)\
\
\>", "Chapter",
 CellChangeTimes->{{3.712045149627686*^9, 3.712045162265546*^9}, {
  3.7120482398738947`*^9, 3.71204825221142*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"PP", ".", "A", ".", 
       RowBox[{"Inverse", "[", "PP", "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Asimilar", "  ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PP", ".", "A", ".", 
         RowBox[{"Inverse", "[", "PP", "]"}]}], ")"}], ",", 
       RowBox[{
        RowBox[{"gravity", ">", "0"}], " ", "&&", " ", 
        RowBox[{"M", ">", "0"}], "&&", 
        RowBox[{"m", ">", "0"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Asimilar", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.69787253396821*^9, 3.6978725370671787`*^9}, {
  3.6978726142932997`*^9, 3.697872631268517*^9}, {3.697874959504425*^9, 
  3.6978749791920137`*^9}, {3.712045168603406*^9, 3.712045269153802*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kiz", " ", "M", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gravity", " ", "m"}], 
             RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "+", 
        RowBox[{"L", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "+", 
        RowBox[{"L", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}]}]], "0", 
      RowBox[{"2", " ", "gravity"}], 
      RowBox[{"2", " ", "gravity"}]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kiz", " ", "M", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gravity", " ", "m"}], 
             RowBox[{"2", " ", "M"}]]}], "]"}], "]"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      FractionBox[
       RowBox[{
        RowBox[{"J", " ", "L", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}]}]}], 
       
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"J", " ", "L", " ", 
          SuperscriptBox["\[Lambda]", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gravity", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M"}], ")"}]}], "+", 
            RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"J", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "M"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "k\[Theta]r", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kvx"}], " ", "k\[Theta]r"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "k\[Theta]r"}], "L"]}], "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", "k\[Theta]r"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", 
         "k\[Theta]r", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k\[Theta]r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "2", " ", "J", " ", "kvy", " ", "k\[Theta]r", " ", "L", " ", "M"}], 
         "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "k\[Theta]r"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7120473672487383`*^9, 3.712047398522624*^9, 
  3.712048254532552*^9, 3.7120491316663017`*^9, 3.712059295532194*^9, 
  3.7133333906425867`*^9, 3.714553548322308*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some properties for chosen saturation function", "Chapter",
 CellChangeTimes->{{3.712048947076632*^9, 3.7120489618529577`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "'"}], "[", 
      RowBox[{
       RowBox[{"InverseFunction", "[", "#", "]"}], "[", "xx", "]"}], "]"}], 
     "&"}], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Sigma]\[Sigma]", " ", "#"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[Sigma]\[Sigma]", "2"], "+", 
        SuperscriptBox["#", "2"]}]]], "&"}], "]"}], ",", 
   RowBox[{"\[Sigma]\[Sigma]", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.713333434823977*^9, 3.713333500709639*^9}, {
  3.713333560074256*^9, 3.713333604219239*^9}}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,171,13,29722343334104733048,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.71333348784342*^9, 3.7133335011275673`*^9}, {
   3.713333570054233*^9, 3.7133336136207447`*^9}, 3.7145535484127607`*^9}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SuperscriptBox["\[Sigma]\[Sigma]", "3"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["xx", "2"]}], "+", 
       SuperscriptBox["\[Sigma]\[Sigma]", "2"]}]], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.7133334878687267`*^9, 3.713333501153371*^9}, {
   3.713333570082571*^9, 3.713333613642313*^9}, 3.714553548564666*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{1390, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 212, 4, 109, "Chapter"],
Cell[CellGroupData[{
Cell[794, 28, 93, 1, 66, "Title"],
Cell[890, 31, 2132, 64, 138, "Input"],
Cell[3025, 97, 5003, 144, 285, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8065, 246, 102, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[8192, 251, 151, 2, 65, "Chapter"],
Cell[8346, 255, 3059, 86, 411, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11442, 346, 112, 1, 65, "Chapter"],
Cell[11557, 349, 2894, 78, 209, "Input"],
Cell[14454, 429, 6513, 168, 306, "Input"],
Cell[CellGroupData[{
Cell[20992, 601, 261, 5, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[21278, 610, 5489, 148, 327, "Input"],
Cell[26770, 760, 205, 5, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27036, 772, 148, 2, 65, "Chapter"],
Cell[27187, 776, 18511, 463, 1209, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45735, 1244, 133, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[45893, 1249, 2071, 52, 138, "Input"],
Cell[47967, 1303, 473, 8, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48489, 1317, 190, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[48704, 1323, 707, 21, 32, "Input"],
Cell[49414, 1346, 550, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50001, 1361, 728, 20, 74, "Input"],
Cell[50732, 1383, 589, 11, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[51382, 1401, 150, 2, 66, "Title"],
Cell[CellGroupData[{
Cell[51557, 1407, 116, 1, 65, "Chapter"],
Cell[51676, 1410, 2833, 88, 227, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54546, 1503, 109, 1, 65, "Chapter"],
Cell[54658, 1506, 5980, 134, 308, "Input"],
Cell[CellGroupData[{
Cell[60663, 1644, 466, 14, 75, "Input"],
Cell[61132, 1660, 589, 11, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[61782, 1678, 119, 1, 66, "Title"],
Cell[61904, 1681, 186, 2, 65, "Chapter"],
Cell[62093, 1685, 166, 3, 54, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[62296, 1693, 125, 1, 66, "Title"],
Cell[62424, 1696, 217, 4, 65, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[62678, 1705, 142, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[62845, 1710, 119, 1, 65, "Chapter"],
Cell[62967, 1713, 574, 15, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63578, 1733, 177, 2, 65, "Chapter"],
Cell[63758, 1737, 2918, 85, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66713, 1827, 122, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[66860, 1832, 103, 1, 63, "Subchapter"],
Cell[66966, 1835, 920, 19, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67923, 1859, 103, 1, 63, "Subchapter"],
Cell[68029, 1862, 2431, 58, 222, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70497, 1925, 135, 1, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[70657, 1930, 2316, 55, 117, "Input"],
Cell[72976, 1987, 1340, 21, 32, "Output"],
Cell[74319, 2010, 1341, 21, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75721, 2038, 157, 2, 65, "Chapter"],
Cell[75881, 2042, 176, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76094, 2051, 111, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[76230, 2056, 1123, 28, 75, "Input"],
Cell[77356, 2086, 618, 11, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78023, 2103, 181, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[78229, 2109, 2345, 64, 278, "Input"],
Cell[80577, 2175, 956, 16, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81582, 2197, 110, 1, 65, "Chapter"],
Cell[81695, 2200, 454, 11, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82186, 2216, 105, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[82316, 2221, 1089, 26, 75, "Input"],
Cell[83408, 2249, 9962, 250, 530, "Output"]
}, Open  ]],
Cell[93385, 2502, 68, 1, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93490, 2508, 102, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[93617, 2513, 2866, 66, 327, "Input"],
Cell[96486, 2581, 666, 11, 32, "Output"],
Cell[97155, 2594, 620, 9, 32, "Output"],
Cell[97778, 2605, 5135, 96, 480, "Output"]
}, Open  ]],
Cell[102928, 2704, 68, 1, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103033, 2710, 237, 5, 65, "Chapter"],
Cell[CellGroupData[{
Cell[103295, 2719, 514, 12, 54, "Input"],
Cell[103812, 2733, 9079, 218, 498, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112940, 2957, 184, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[113149, 2965, 3645, 105, 302, "Input"],
Cell[116797, 3072, 902, 14, 32, "Output"],
Cell[117702, 3088, 902, 14, 32, "Output"],
Cell[118607, 3104, 902, 14, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[119570, 3125, 238, 3, 66, "Title"],
Cell[119811, 3130, 233, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[120069, 3137, 166, 2, 54, "Chapter"],
Cell[120238, 3141, 2940, 77, 202, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123215, 3223, 124, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[123364, 3228, 4120, 125, 222, "Input"],
Cell[127487, 3355, 604, 11, 32, "Output"],
Cell[128094, 3368, 604, 11, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128747, 3385, 117, 1, 65, "Chapter"],
Cell[128867, 3388, 495, 14, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129399, 3407, 112, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[129536, 3412, 157, 4, 32, "Input"],
Cell[129696, 3418, 630, 11, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130375, 3435, 189, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[130589, 3441, 418, 12, 54, "Input"],
Cell[131010, 3455, 607, 11, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131666, 3472, 112, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[131803, 3477, 2274, 52, 117, "Input"],
Cell[134080, 3531, 922, 16, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135051, 3553, 162, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[135238, 3560, 2085, 53, 243, "Input"],
Cell[137326, 3615, 930, 15, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138305, 3636, 97, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[138427, 3641, 1249, 29, 54, "Input"],
Cell[139679, 3672, 20770, 555, 692, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160498, 4233, 102, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[160625, 4238, 3839, 90, 348, "Input"],
Cell[164467, 4330, 378, 7, 32, "Output"],
Cell[164848, 4339, 332, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[165229, 4350, 127, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[165381, 4355, 950, 24, 75, "Input"],
Cell[166334, 4381, 13239, 314, 600, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179622, 4701, 104, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[179751, 4706, 1462, 44, 92, "Input"],
Cell[181216, 4752, 344, 7, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181609, 4765, 107, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[181741, 4770, 3647, 109, 260, "Input"],
Cell[185391, 4881, 390, 7, 32, "Output"],
Cell[185784, 4890, 390, 7, 32, "Output"],
Cell[186177, 4899, 388, 7, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[186626, 4913, 270, 3, 66, "Title"],
Cell[CellGroupData[{
Cell[186921, 4920, 136, 1, 65, "Chapter"],
Cell[187060, 4923, 977, 30, 47, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188074, 4958, 105, 1, 65, "Chapter"],
Cell[188182, 4961, 812, 24, 117, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189031, 4990, 105, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[189161, 4995, 352, 9, 54, "Input"],
Cell[189516, 5006, 456, 8, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190021, 5020, 117, 1, 65, "Chapter"],
Cell[190141, 5023, 1248, 39, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191426, 5067, 118, 1, 65, "Chapter"],
Cell[191547, 5070, 1207, 28, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192791, 5103, 119, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[192935, 5108, 220, 6, 54, "Input"],
Cell[193158, 5116, 458, 8, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193665, 5130, 125, 1, 65, "Chapter"],
Cell[193793, 5133, 2055, 54, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195885, 5192, 97, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[196007, 5197, 793, 22, 54, "Input"],
Cell[196803, 5221, 22072, 587, 728, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[218924, 5814, 102, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[219051, 5819, 4950, 125, 390, "Input"],
Cell[224004, 5946, 400, 7, 32, "Output"],
Cell[224407, 5955, 353, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224809, 5966, 105, 1, 65, "Chapter"],
Cell[224917, 5969, 2487, 71, 177, "Input"],
Cell[CellGroupData[{
Cell[227429, 6044, 1264, 32, 75, "Input"],
Cell[228696, 6078, 320, 6, 32, "Output"],
Cell[229019, 6086, 408, 10, 32, "Output"],
Cell[229430, 6098, 309, 6, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229788, 6110, 114, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[229927, 6115, 2302, 69, 202, "Input"],
Cell[232232, 6186, 225, 4, 32, "Output"],
Cell[232460, 6192, 327, 8, 32, "Output"],
Cell[232790, 6202, 253, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233092, 6213, 178, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[233295, 6219, 950, 24, 75, "Input"],
Cell[234248, 6245, 14503, 343, 626, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[248812, 6595, 295, 4, 66, "Title"],
Cell[CellGroupData[{
Cell[249132, 6603, 136, 1, 65, "Chapter"],
Cell[249271, 6606, 6692, 165, 439, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256000, 6776, 105, 1, 65, "Chapter"],
Cell[256108, 6779, 812, 24, 117, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256957, 6808, 105, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[257087, 6813, 114, 1, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[257226, 6818, 1122, 34, 95, "Input"],
Cell[258351, 6854, 292, 6, 24, "Message"],
Cell[258646, 6862, 292, 6, 24, "Message"],
Cell[258941, 6870, 536, 17, 46, "Output"],
Cell[259480, 6889, 292, 6, 24, "Message"],
Cell[259775, 6897, 291, 6, 24, "Message"],
Cell[260069, 6905, 458, 8, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[260588, 6920, 117, 1, 65, "Chapter"],
Cell[260708, 6923, 136, 1, 63, "Subchapter"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260881, 6929, 118, 1, 65, "Chapter"],
Cell[261002, 6932, 1207, 28, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262246, 6965, 119, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[262390, 6970, 220, 6, 54, "Input"],
Cell[262613, 6978, 268, 6, 24, "Message"],
Cell[262884, 6986, 268, 6, 24, "Message"],
Cell[263155, 6994, 270, 6, 24, "Message"],
Cell[263428, 7002, 348, 7, 24, "Message"],
Cell[263779, 7011, 434, 8, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[264262, 7025, 125, 1, 65, "Chapter"],
Cell[264390, 7028, 1788, 50, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266215, 7083, 97, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[266337, 7088, 1059, 26, 54, "Input"],
Cell[267399, 7116, 356, 7, 24, "Message"],
Cell[267758, 7125, 358, 7, 24, "Message"],
Cell[268119, 7134, 360, 7, 24, "Message"],
Cell[268482, 7143, 438, 8, 24, "Message"],
Cell[268923, 7153, 23425, 625, 732, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[292397, 7784, 106, 1, 65, "Chapter"],
Cell[292506, 7787, 131, 1, 63, "Subchapter"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292674, 7793, 222, 5, 65, "Chapter"],
Cell[CellGroupData[{
Cell[292921, 7802, 950, 24, 75, "Input"],
Cell[293874, 7828, 15531, 374, 640, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[309454, 8208, 133, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[309612, 8213, 635, 19, 60, "Input"],
Cell[310250, 8234, 370, 7, 24, "Message"],
Cell[310623, 8243, 475, 13, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

